<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ø£Ø¯Ø§Ø© ØªØ­Ù„ÙŠÙ„ Ù…Ù„ÙØ§Øª Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ - Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ù…Ø­Ø³Ù†Ø©</title>

<style>
:root {
    --primary-color: #3498db;
    --secondary-color: #2c3e50;
    --success-color: #27ae60;
    --danger-color: #e74c3c;
    --warning-color: #f39c12;
    --light-color: #ecf0f1;
    --dark-color: #34495e;
    --border-radius: 8px;
    --box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}

* {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
}

body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    direction: rtl;
    background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
    color: #333;
    line-height: 1.6;
    padding: 20px;
    min-height: 100vh;
}

.container {
    max-width: 1200px;
    margin: 0 auto;
    background: rgba(255, 255, 255, 0.9);
    border-radius: var(--border-radius);
    box-shadow: var(--box-shadow);
    padding: 25px;
    backdrop-filter: blur(10px);
}

header {
    text-align: center;
    margin-bottom: 30px;
    padding-bottom: 20px;
    border-bottom: 1px solid #eee;
}

h1 {
    color: var(--secondary-color);
    margin-bottom: 10px;
    font-size: 2.2rem;
}

h2 {
    color: var(--secondary-color);
    margin: 25px 0 15px;
    font-size: 1.5rem;
}

h3 {
    color: var(--secondary-color);
    margin: 20px 0 10px;
    font-size: 1.2rem;
}

h4 {
    color: var(--primary-color);
    margin: 15px 0 10px;
    font-size: 1.1rem;
}

.controls {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    margin-bottom: 20px;
    justify-content: center;
}

.btn {
    padding: 10px 20px;
    border: none;
    border-radius: var(--border-radius);
    cursor: pointer;
    font-weight: bold;
    transition: all 0.3s ease;
    display: inline-flex;
    align-items: center;
    gap: 8px;
}

.btn-primary {
    background-color: var(--primary-color);
    color: white;
}

.btn-primary:hover {
    background-color: #2980b9;
    transform: translateY(-2px);
}

.btn-success {
    background-color: var(--success-color);
    color: white;
}

.btn-success:hover {
    background-color: #219653;
    transform: translateY(-2px);
}

.btn-warning {
    background-color: var(--warning-color);
    color: white;
}

.btn-warning:hover {
    background-color: #e67e22;
    transform: translateY(-2px);
}

.btn-danger {
    background-color: var(--danger-color);
    color: white;
}

.btn-danger:hover {
    background-color: #c0392b;
    transform: translateY(-2px);
}

.btn-secondary {
    background-color: var(--secondary-color);
    color: white;
}

.btn-secondary:hover {
    background-color: #1a252f;
    transform: translateY(-2px);
}

.stats {
    display: flex;
    justify-content: space-around;
    flex-wrap: wrap;
    margin: 20px 0;
    gap: 15px;
}

.stat-card {
    background: white;
    padding: 15px;
    border-radius: var(--border-radius);
    box-shadow: var(--box-shadow);
    text-align: center;
    flex: 1;
    min-width: 150px;
}

.stat-value {
    font-size: 2rem;
    font-weight: bold;
    color: var(--primary-color);
}

.stat-label {
    font-size: 0.9rem;
    color: var(--dark-color);
}

textarea {
    width: 100%;
    height: 250px;
    margin-top: 10px;
    padding: 15px;
    border: 1px solid #ddd;
    border-radius: var(--border-radius);
    font-family: 'Courier New', monospace;
    resize: vertical;
    direction: ltr;
}

.list-box {
    background: white;
    border: 1px solid #ddd;
    border-radius: var(--border-radius);
    padding: 15px;
    max-height: 400px;
    overflow-y: auto;
    box-shadow: var(--box-shadow);
}

.folder {
    color: var(--primary-color);
    font-weight: bold;
    cursor: pointer;
    padding: 8px 5px;
    border-radius: 4px;
    transition: background 0.2s;
    display: flex;
    align-items: center;
    gap: 8px;
}

.folder:hover {
    background-color: #f0f8ff;
}

.file {
    color: var(--success-color);
    cursor: pointer;
    padding: 6px 5px;
    margin-right: 15px;
    border-radius: 4px;
    transition: background 0.2s;
    display: flex;
    align-items: center;
    gap: 8px;
}

.file:hover {
    background-color: #f0fff0;
}

.ignore-btn {
    background: var(--danger-color);
    color: white;
    border: none;
    padding: 4px 8px;
    margin-right: 10px;
    border-radius: 4px;
    cursor: pointer;
    font-size: 0.8rem;
    transition: background 0.2s;
}

.ignore-btn:hover {
    background: #c0392b;
}

.sub {
    margin-right: 20px;
    display: none;
}

.search-box {
    margin: 15px 0;
    display: flex;
    gap: 10px;
}

.search-box input {
    flex: 1;
    padding: 10px;
    border: 1px solid #ddd;
    border-radius: var(--border-radius);
}

.file-type-filters {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    margin: 15px 0;
}

.file-type-btn {
    padding: 8px 15px;
    border: 1px solid #ddd;
    border-radius: var(--border-radius);
    background: white;
    cursor: pointer;
    transition: all 0.2s;
}

.file-type-btn.active {
    background: var(--primary-color);
    color: white;
    border-color: var(--primary-color);
}

.file-type-btn:hover {
    background: #f0f0f0;
}

.file-type-btn.active:hover {
    background: #2980b9;
}

.search-results {
    background: #f8f9fa;
    border: 1px solid #e9ecef;
    border-radius: var(--border-radius);
    padding: 15px;
    margin: 15px 0;
}

.search-result-item {
    background: white;
    padding: 10px;
    margin: 8px 0;
    border-radius: var(--border-radius);
    border-right: 4px solid var(--primary-color);
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.search-result-header {
    font-weight: bold;
    color: var(--secondary-color);
    margin-bottom: 5px;
    display: flex;
    align-items: center;
    gap: 8px;
}

.search-result-content {
    margin-right: 25px;
}

.function-list {
    list-style: none;
    margin: 10px 0;
}

.function-list li {
    padding: 5px 10px;
    margin: 3px 0;
    background: #f8f9fa;
    border-radius: 4px;
    border-right: 3px solid var(--success-color);
}

.dependency-list {
    list-style: none;
    margin: 10px 0;
}

.dependency-list li {
    padding: 5px 10px;
    margin: 3px 0;
    background: #fff3cd;
    border-radius: 4px;
    border-right: 3px solid var(--warning-color);
}

.relation-list {
    list-style: none;
    margin: 10px 0;
}

.relation-list li {
    padding: 5px 10px;
    margin: 3px 0;
    background: #d1ecf1;
    border-radius: 4px;
    border-right: 3px solid var(--primary-color);
}

/* Ù†Ø§ÙØ°Ø© Ø¹Ø±Ø¶ Ù…Ø­ØªÙˆÙ‰ Ù…Ù„Ù ÙˆØ§Ø­Ø¯ */
#modal {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.7);
    display: none;
    justify-content: center;
    align-items: center;
    z-index: 1000;
    padding: 20px;
}

#modalContent {
    background: white;
    width: 90%;
    max-width: 900px;
    height: 80%;
    padding: 25px;
    overflow-y: auto;
    border-radius: var(--border-radius);
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
    position: relative;
}

#modalClose {
    position: absolute;
    top: 15px;
    left: 15px;
    background: var(--danger-color);
    color: white;
    border: none;
    width: 30px;
    height: 30px;
    border-radius: 50%;
    cursor: pointer;
    display: flex;
    justify-content: center;
    align-items: center;
    font-weight: bold;
}

.file-content {
    direction: ltr;
    white-space: pre-wrap;
    font-family: 'Courier New', monospace;
    margin-top: 20px;
}

.file-info {
    background: #f8f9fa;
    padding: 10px 15px;
    border-radius: var(--border-radius);
    margin-bottom: 15px;
    border-right: 4px solid var(--primary-color);
}

.loading {
    display: none;
    text-align: center;
    padding: 20px;
}

.spinner {
    border: 4px solid rgba(0, 0, 0, 0.1);
    border-left-color: var(--primary-color);
    border-radius: 50%;
    width: 40px;
    height: 40px;
    animation: spin 1s linear infinite;
    margin: 0 auto 15px;
}

@keyframes spin {
    to { transform: rotate(360deg); }
}

@media (max-width: 768px) {
    .container {
        padding: 15px;
    }
    
    .controls {
        flex-direction: column;
    }
    
    .btn {
        width: 100%;
        justify-content: center;
    }
    
    .stats {
        flex-direction: column;
    }
    
    .stat-card {
        min-width: 100%;
    }
    
    .search-box {
        flex-direction: column;
    }
}
</style>
</head>
<body>

<div class="container">
    <header>
        <h1>ğŸ“‚ Ø£Ø¯Ø§Ø© ØªØ­Ù„ÙŠÙ„ Ù…Ù„ÙØ§Øª Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ - Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ù…Ø­Ø³Ù†Ø©</h1>
        <p>Ø£Ø¯Ø§Ø© Ù…ØªÙƒØ§Ù…Ù„Ø© Ù„Ù‚Ø±Ø§Ø¡Ø© ÙˆØªØ­Ù„ÙŠÙ„ ÙˆØªØµØ¯ÙŠØ± Ù…Ù„ÙØ§Øª Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹ Ø§Ù„Ø¨Ø±Ù…Ø¬ÙŠØ© Ù…Ø¹ ØªØ­Ù„ÙŠÙ„ Ù…Ø¹Ù…Ù‚ Ù„Ù„Ø¹Ù„Ø§Ù‚Ø§Øª</p>
    </header>

    <div class="controls">
        <button id="pickFolder" class="btn btn-primary">
            <span>ğŸ“</span> Ø§Ø®ØªØ± Ù…Ø¬Ù„Ø¯ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹
        </button>
        <button id="reRead" class="btn btn-secondary">
            <span>ğŸ”„</span> Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©
        </button>
        <button id="exportTxt" class="btn btn-success">
            <span>ğŸ“„</span> ØªØµØ¯ÙŠØ± ÙƒÙ…Ø­ØªÙˆÙ‰ TXT
        </button>
        <button id="exportMd" class="btn btn-success">
            <span>ğŸ“</span> ØªØµØ¯ÙŠØ± ÙƒÙ€ MD
        </button>
        <button id="exportByType" class="btn btn-warning">
            <span>ğŸ“Š</span> ØªØµØ¯ÙŠØ± Ø­Ø³Ø¨ Ø§Ù„Ù†ÙˆØ¹ Ù…Ø¹ Ø§Ù„ØªØ­Ù„ÙŠÙ„
        </button>
        <button id="exportRelations" class="btn btn-primary">
            <span>ğŸ”—</span> ØªØµØ¯ÙŠØ± Ø®Ø±ÙŠØ·Ø© Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª
        </button>
    </div>

    <div class="loading" id="loading">
        <div class="spinner"></div>
        <p>Ø¬Ø§Ø±ÙŠ ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ù„ÙØ§Øª ÙˆØ§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª...</p>
    </div>

    <div class="stats">
        <div class="stat-card">
            <div class="stat-value" id="fileCount">0</div>
            <div class="stat-label">Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ù„ÙØ§Øª</div>
        </div>
        <div class="stat-card">
            <div class="stat-value" id="lineCount">0</div>
            <div class="stat-label">Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø³Ø·Ø±</div>
        </div>
        <div class="stat-card">
            <div class="stat-value" id="totalSize">0 KB</div>
            <div class="stat-label">Ø§Ù„Ø­Ø¬Ù… Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ</div>
        </div>
        <div class="stat-card">
            <div class="stat-value" id="projectName">-</div>
            <div class="stat-label">Ø§Ø³Ù… Ø§Ù„Ù…Ø´Ø±ÙˆØ¹</div>
        </div>
        <div class="stat-card">
            <div class="stat-value" id="relationCount">0</div>
            <div class="stat-label">Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª Ø§Ù„Ù…ÙƒØªØ´ÙØ©</div>
        </div>
    </div>

    <!-- Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ù…Ù„ÙØ§Øª -->
    <h3>ğŸ” Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ù…Ù„ÙØ§Øª</h3>
    <div class="search-box">
        <input type="text" id="fileSearchInput" placeholder="Ø§Ø¨Ø­Ø« Ø¨Ø§Ø³Ù… Ø§Ù„Ù…Ù„Ù Ø£Ùˆ Ø§Ù„Ø§Ù…ØªØ¯Ø§Ø¯ (Ù…Ø«Ø§Ù„: main.js Ø£Ùˆ .css)">
        <button id="searchFile" class="btn btn-primary">Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ù…Ù„ÙØ§Øª</button>
        <button id="clearFileSearch" class="btn btn-secondary">Ù…Ø³Ø­</button>
    </div>
    <div id="fileSearchResults" class="search-results" style="display: none;"></div>

    <!-- Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ø¯ÙˆØ§Ù„ -->
    <h3>ğŸ” Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ø¯ÙˆØ§Ù„</h3>
    <div class="search-box">
        <input type="text" id="functionSearchInput" placeholder="Ø§Ø¨Ø­Ø« Ø¨Ø§Ø³Ù… Ø§Ù„Ø¯Ø§Ù„Ø© (Ù…Ø«Ø§Ù„: calculate Ø£Ùˆ init)">
        <button id="searchFunction" class="btn btn-primary">Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ø¯ÙˆØ§Ù„</button>
        <button id="clearFunctionSearch" class="btn btn-secondary">Ù…Ø³Ø­</button>
    </div>
    <div id="functionSearchResults" class="search-results" style="display: none;"></div>

    <div class="search-box">
        <input type="text" id="searchInput" placeholder="Ø§Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ù…Ù„ÙØ§Øª ÙˆØ§Ù„Ù…Ø¬Ù„Ø¯Ø§Øª...">
        <button id="clearSearch" class="btn btn-secondary">Ù…Ø³Ø­ Ø§Ù„Ø¨Ø­Ø«</button>
    </div>

    <div class="file-type-filters">
        <button class="file-type-btn active" data-type="all">Ø§Ù„ÙƒÙ„</button>
        <button class="file-type-btn" data-type="html">HTML</button>
        <button class="file-type-btn" data-type="css">CSS</button>
        <button class="file-type-btn" data-type="js">JavaScript</button>
        <button class="file-type-btn" data-type="json">JSON</button>
        <button class="file-type-btn" data-type="other">Ø£Ø®Ø±Ù‰</button>
    </div>

    <h3>ğŸ“ Ù…Ù„ÙØ§Øª Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ (Ù…Ù†Ø¸Ù…Ø© Ø´Ø¬Ø±ÙŠÙ‹Ø§):</h3>
    <div class="list-box" id="treeView"></div>

    <h3>ğŸ“ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…Ø¬Ù…Ù‘Ø¹:</h3>
    <textarea id="output" placeholder="Ø³ÙŠØ¸Ù‡Ø± Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…Ù„ÙØ§Øª Ù‡Ù†Ø§ Ø¨Ø¹Ø¯ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…Ø¬Ù„Ø¯..."></textarea>

    <h3>ğŸ”— Ø®Ø±ÙŠØ·Ø© Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª Ø§Ù„Ù…ÙƒØªØ´ÙØ©:</h3>
    <div class="list-box" id="relationsView"></div>

    <h3>ğŸ“› Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ØªØ¬Ø§Ù‡Ù„ (Ù…Ù„ÙØ§Øª Ø£Ùˆ Ù…Ø¬Ù„Ø¯Ø§Øª):</h3>
    <textarea id="ignoreList" placeholder="Ø£Ø¯Ø®Ù„ Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ù…Ù„ÙØ§Øª Ø£Ùˆ Ø§Ù„Ù…Ø¬Ù„Ø¯Ø§Øª Ø§Ù„ØªÙŠ ØªØ±ÙŠØ¯ ØªØ¬Ø§Ù‡Ù„Ù‡Ø§ (Ø³Ø·Ø± Ù„ÙƒÙ„ Ø§Ø³Ù…)"></textarea>
    <div class="controls">
        <button id="saveIgnore" class="btn btn-danger">Ø­ÙØ¸ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ØªØ¬Ø§Ù‡Ù„</button>
        <button id="resetIgnore" class="btn btn-secondary">Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©</button>
    </div>
</div>

<!-- Ù†Ø§ÙØ°Ø© Ø¹Ø±Ø¶ Ù…Ù„Ù -->
<div id="modal">
    <div id="modalContent">
        <button id="modalClose">âœ•</button>
        <div id="fileInfo" class="file-info"></div>
        <div id="fileContent" class="file-content"></div>
    </div>
</div>

<script>
let directoryHandle = null;
let projectName = "";

let cssContent   = "";
let htmlContent  = "";
let jsContent    = "";
let jsonContent  = "";
let otherContent = "";

// Ù‡ÙŠØ§ÙƒÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ù…ØªÙ‚Ø¯Ù…Ø© Ù„ØªØªØ¨Ø¹ Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª
let relations = {
    html: {},
    css: {},
    js: {},
    json: {},
    other: {}
};

let dependencyMap = {
    htmlToCss: {},
    htmlToJs: {},
    cssToJs: {},
    jsToJson: {},
    jsToHtml: {},
    crossReferences: {}
};

let projectStructure = {
    entryPoints: [],
    components: {},
    modules: {},
    dataFlows: [],
    architecture: {}
};

// Ù‡ÙŠØ§ÙƒÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø¬Ø¯ÙŠØ¯Ø© Ù„Ù„Ø¨Ø­Ø« Ø§Ù„Ù…ØªÙ‚Ø¯Ù…
let fileAnalysis = {};
let functionAnalysis = {};
let fileDependencies = {};
let functionDependencies = {};
let reverseDependencies = {};

// ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
document.addEventListener('DOMContentLoaded', function() {
    document.getElementById("ignoreList").value =
        localStorage.getItem("ignored") || "node_modules\n.git\n.vscode\n.DS_Store\nThumbs.db";

    // Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªÙ…Ø¹ÙŠ Ø§Ù„Ø£Ø­Ø¯Ø§Ø«
    document.getElementById("pickFolder").addEventListener("click", pickFolder);
    document.getElementById("reRead").addEventListener("click", readAll);
    document.getElementById("exportTxt").addEventListener("click", exportTxt);
    document.getElementById("exportMd").addEventListener("click", exportMd);
    document.getElementById("exportByType").addEventListener("click", exportByType);
    document.getElementById("exportRelations").addEventListener("click", exportRelations);
    document.getElementById("saveIgnore").addEventListener("click", saveIgnore);
    document.getElementById("resetIgnore").addEventListener("click", resetIgnore);
    document.getElementById("modalClose").addEventListener("click", closeModal);
    document.getElementById("searchInput").addEventListener("input", filterTree);
    document.getElementById("clearSearch").addEventListener("click", clearSearch);
    
    // Ø£Ø­Ø¯Ø§Ø« Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
    document.getElementById("searchFile").addEventListener("click", searchFiles);
    document.getElementById("clearFileSearch").addEventListener("click", clearFileSearch);
    document.getElementById("searchFunction").addEventListener("click", searchFunctions);
    document.getElementById("clearFunctionSearch").addEventListener("click", clearFunctionSearch);
    document.getElementById("fileSearchInput").addEventListener("keypress", function(e) {
        if (e.key === 'Enter') searchFiles();
    });
    document.getElementById("functionSearchInput").addEventListener("keypress", function(e) {
        if (e.key === 'Enter') searchFunctions();
    });
    
    // Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªÙ…Ø¹ÙŠ Ø§Ù„Ø£Ø­Ø¯Ø§Ø« Ù„Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØµÙÙŠØ© Ø­Ø³Ø¨ Ø§Ù„Ù†ÙˆØ¹
    document.querySelectorAll('.file-type-btn').forEach(btn => {
        btn.addEventListener('click', function() {
            document.querySelectorAll('.file-type-btn').forEach(b => b.classList.remove('active'));
            this.classList.add('active');
            filterByType(this.dataset.type);
        });
    });
    
    // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø© Ø¨Ø§Ù„Ù†Ù‚Ø± Ø®Ø§Ø±Ø¬ Ø§Ù„Ù…Ø­ØªÙˆÙ‰
    document.getElementById("modal").addEventListener("click", function(e) {
        if (e.target === this) closeModal();
    });
});

async function pickFolder() {
    try {
        directoryHandle = await window.showDirectoryPicker();
        projectName = directoryHandle.name;
        document.getElementById("projectName").textContent = projectName;
        await readAll();
    } catch (error) {
        if (error.name !== 'AbortError') {
            alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…Ø¬Ù„Ø¯: ' + error.message);
        }
    }
}

async function readAll() {
    if (!directoryHandle) {
        alert('ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù…Ø¬Ù„Ø¯ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ Ø£ÙˆÙ„Ø§Ù‹');
        return;
    }
    
    showLoading(true);
    
    let output = "";
    let fileCount = 0;
    let lineCount = 0;
    let totalSize = 0;

    cssContent   = "";
    htmlContent  = "";
    jsContent    = "";
    jsonContent  = "";
    otherContent = "";

    // Ø¥Ø¹Ø§Ø¯Ø© ØªÙ‡ÙŠØ¦Ø© Ù‡ÙŠØ§ÙƒÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
    relations = { html:{}, css:{}, js:{}, json:{}, other:{} };
    dependencyMap = {
        htmlToCss: {},
        htmlToJs: {},
        cssToJs: {},
        jsToJson: {},
        jsToHtml: {},
        crossReferences: {}
    };
    projectStructure = {
        entryPoints: [],
        components: {},
        modules: {},
        dataFlows: [],
        architecture: {}
    };
    
    // Ø¥Ø¹Ø§Ø¯Ø© ØªÙ‡ÙŠØ¦Ø© Ù‡ÙŠØ§ÙƒÙ„ Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
    fileAnalysis = {};
    functionAnalysis = {};
    fileDependencies = {};
    functionDependencies = {};
    reverseDependencies = {};

    let ignored = document.getElementById("ignoreList").value
        .split("\n").map(s => s.trim()).filter(s => s);

    async function traverse(dirHandle, path="") {
        let treeHTML = `<div class="folder" data-path="${path || '/'}" data-type="folder">
            <span>ğŸ“</span> ${path || "/"}
        </div>
        <div class="sub" style="display:none;">`;

        for await (let [name, handle] of dirHandle.entries()) {
            // ØªØ¬Ø§Ù‡Ù„ Ø§Ù„Ø¹Ù†Ø§ØµØ± ÙÙŠ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ØªØ¬Ø§Ù‡Ù„
            if (ignored.includes(name)) continue;

            let fullPath = path ? `${path}/${name}` : name;

            if (handle.kind === "file") {
                let fileType = getFileType(name);
                let file = await handle.getFile();
                let text = await file.text();
                let sizeKB = (file.size / 1024).toFixed(2);

                treeHTML += `
                    <div class="file" data-path="${fullPath}" data-type="${fileType}">
                        <span>${getFileIcon(fileType)}</span> ${name}
                        <span style="margin-right: auto; font-size: 0.8rem; color: #777;">${sizeKB} KB</span>
                        <button class="ignore-btn" onclick="ignoreItem(event, '${name}')">ØªØ¬Ø§Ù‡Ù„</button>
                    </div>
                `;

                output += `\n------ Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ù…Ù„Ù: ${fullPath} ------\n`;
                output += text;
                output += `\n------ Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ù…Ù„Ù: ${fullPath} ------\n`;

                fileCount++;
                lineCount += text.split("\n").length;
                totalSize += file.size;

                // ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª ÙˆØ§Ù„ØªØ¨Ø¹ÙŠØ§Øª
                analyzeFileRelations(fullPath, fileType, text);
                
                // Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…ØªÙ‚Ø¯Ù… Ù„Ù„Ù…Ù„ÙØ§Øª ÙˆØ§Ù„Ø¯ÙˆØ§Ù„
                performAdvancedAnalysis(fullPath, fileType, text);
                
                // Ø¥Ù†Ø´Ø§Ø¡ ÙˆØµÙ ØªÙØµÙŠÙ„ÙŠ Ù„Ù„Ù…Ù„Ù
                let relationText = generateFileDescription(name, fullPath, fileType, text);
                
                // ØªØµÙ†ÙŠÙ Ø­Ø³Ø¨ Ø§Ù„Ù†ÙˆØ¹ + Ø¥Ø¶Ø§ÙØ© Ø¹Ù„Ø§Ù‚Ø©
                switch(fileType) {
                    case "css":
                        relations.css[fullPath] = relationText;
                        cssContent += `\n/* FILE: ${fullPath} */\n/* DESCRIPTION: ${relationText} */\n${text}\n`;
                        break;
                    case "html":
                        relations.html[fullPath] = relationText;
                        htmlContent += `\n<!-- FILE: ${fullPath} -->\n<!-- DESCRIPTION: ${relationText} -->\n${text}\n`;
                        break;
                    case "js":
                        relations.js[fullPath] = relationText;
                        jsContent += `\n// FILE: ${fullPath}\n// DESCRIPTION: ${relationText}\n${text}\n`;
                        break;
                    case "json":
                        relations.json[fullPath] = relationText;
                        jsonContent += `\n// FILE: ${fullPath}\n// DESCRIPTION: ${relationText}\n${text}\n`;
                        break;
                    default:
                        relations.other[fullPath] = relationText;
                        otherContent += `\n# FILE: ${fullPath}\n# DESCRIPTION: ${relationText}\n${text}\n`;
                }
            }
            else if (handle.kind === "directory") {
                treeHTML += `
                    <div class="folder" data-path="${fullPath}" data-type="folder">
                        <span>ğŸ“</span> ${name}
                        <button class="ignore-btn" onclick="ignoreItem(event, '${name}')">ØªØ¬Ø§Ù‡Ù„</button>
                    </div>`;
                treeHTML += `<div class="sub" style="display:none;">`;
                treeHTML += await traverse(handle, fullPath);
                treeHTML += `</div>`;
            }
        }

        treeHTML += "</div>";
        return treeHTML;
    }

    try {
        document.getElementById("treeView").innerHTML = await traverse(directoryHandle);
        
        // Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªÙ…Ø¹ÙŠ Ø§Ù„Ø£Ø­Ø¯Ø§Ø« Ù„Ù„Ù…Ø¬Ù„Ø¯Ø§Øª
        document.querySelectorAll('.folder').forEach(folder => {
            folder.addEventListener('click', function(e) {
                if (!e.target.classList.contains('ignore-btn')) {
                    toggleFolder(this);
                }
            });
        });
        
        // Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªÙ…Ø¹ÙŠ Ø§Ù„Ø£Ø­Ø¯Ø§Ø« Ù„Ù„Ù…Ù„ÙØ§Øª
        document.querySelectorAll('.file').forEach(file => {
            file.addEventListener('click', function(e) {
                if (!e.target.classList.contains('ignore-btn')) {
                    openFile(this.dataset.path);
                }
            });
        });

        document.getElementById("output").value = output;
        document.getElementById("fileCount").innerText = fileCount;
        document.getElementById("lineCount").innerText = lineCount;
        document.getElementById("totalSize").innerText = (totalSize / 1024).toFixed(2) + " KB";
        
        // ØªØ­Ø¯ÙŠØ« Ø®Ø±ÙŠØ·Ø© Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª
        updateRelationsView();
        
        showLoading(false);
    } catch (error) {
        showLoading(false);
        alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ù…Ù„ÙØ§Øª: ' + error.message);
    }
}

// Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…ØªÙ‚Ø¯Ù… Ù„Ù„Ù…Ù„ÙØ§Øª ÙˆØ§Ù„Ø¯ÙˆØ§Ù„
function performAdvancedAnalysis(filePath, fileType, content) {
    fileAnalysis[filePath] = {
        type: fileType,
        functions: [],
        dependencies: [],
        dependents: [],
        size: content.length,
        lines: content.split('\n').length
    };

    if (fileType === "js") {
        analyzeJavaScriptFunctions(filePath, content);
    } else if (fileType === "html") {
        analyzeHTMLDependencies(filePath, content);
    } else if (fileType === "css") {
        analyzeCSSDependencies(filePath, content);
    }
}

// ØªØ­Ù„ÙŠÙ„ Ø¯ÙˆØ§Ù„ JavaScript
function analyzeJavaScriptFunctions(filePath, content) {
    const functionRegex = /(?:function\s+(\w+)|const\s+(\w+)\s*=\s*(?:\([^)]*\)\s*=>|function)|let\s+(\w+)\s*=\s*(?:\([^)]*\)\s*=>|function)|var\s+(\w+)\s*=\s*(?:\([^)]*\)\s*=>|function)|class\s+(\w+))/g;
    let match;
    
    while ((match = functionRegex.exec(content)) !== null) {
        const functionName = match[1] || match[2] || match[3] || match[4] || match[5];
        if (functionName) {
            fileAnalysis[filePath].functions.push(functionName);
            functionAnalysis[functionName] = {
                file: filePath,
                dependencies: findFunctionDependencies(content, functionName),
                calls: findFunctionCalls(content, functionName),
                definition: extractFunctionDefinition(content, functionName)
            };
        }
    }
}

// Ø¥ÙŠØ¬Ø§Ø¯ ØªØ¨Ø¹ÙŠØ§Øª Ø§Ù„Ø¯Ø§Ù„Ø©
function findFunctionDependencies(content, functionName) {
    const dependencies = new Set();
    const functionBody = extractFunctionBody(content, functionName);
    
    if (functionBody) {
        // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ø³ØªØ¯Ø¹Ø§Ø¡Ø§Øª Ø¯ÙˆØ§Ù„ Ø£Ø®Ø±Ù‰
        const functionCallRegex = /(\w+)\s*\(/g;
        let callMatch;
        while ((callMatch = functionCallRegex.exec(functionBody)) !== null) {
            const calledFunction = callMatch[1];
            if (calledFunction !== functionName && !isReservedKeyword(calledFunction)) {
                dependencies.add(calledFunction);
            }
        }
        
        // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ù…ØªØºÙŠØ±Ø§Øª Ø¹Ø§Ù„Ù…ÙŠØ©
        const globalVarRegex = /window\.(\w+)|document\.(\w+)/g;
        let globalMatch;
        while ((globalMatch = globalVarRegex.exec(functionBody)) !== null) {
            const globalVar = globalMatch[1] || globalMatch[2];
            dependencies.add(globalVar);
        }
    }
    
    return Array.from(dependencies);
}

// Ø¥ÙŠØ¬Ø§Ø¯ Ù…Ù† ÙŠØ³ØªØ¯Ø¹ÙŠ Ø§Ù„Ø¯Ø§Ù„Ø©
function findFunctionCalls(content, functionName) {
    const calls = [];
    const callRegex = new RegExp(`\\b${functionName}\\s*\\(`, 'g');
    let callMatch;
    
    while ((callMatch = callRegex.exec(content)) !== null) {
        const lineNumber = content.substring(0, callMatch.index).split('\n').length;
        calls.push({ line: lineNumber, context: extractCallContext(content, callMatch.index) });
    }
    
    return calls;
}

// Ø§Ø³ØªØ®Ø±Ø§Ø¬ ØªØ¹Ø±ÙŠÙ Ø§Ù„Ø¯Ø§Ù„Ø©
function extractFunctionDefinition(content, functionName) {
    const functionRegex = new RegExp(`(?:function\\s+${functionName}|(?:const|let|var)\\s+${functionName}\\s*=\\s*(?:\\([^)]*\\)\\s*=>|function))[^{]*{`, 'g');
    const match = functionRegex.exec(content);
    return match ? match[0] : null;
}

// Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø¬Ø³Ù… Ø§Ù„Ø¯Ø§Ù„Ø©
function extractFunctionBody(content, functionName) {
    const functionStartRegex = new RegExp(`(?:function\\s+${functionName}|(?:const|let|var)\\s+${functionName}\\s*=\\s*(?:\\([^)]*\\)\\s*=>|function))[^{]*{`, 'g');
    const match = functionStartRegex.exec(content);
    
    if (match) {
        let braceCount = 1;
        let index = match.index + match[0].length;
        
        while (index < content.length && braceCount > 0) {
            if (content[index] === '{') braceCount++;
            if (content[index] === '}') braceCount--;
            index++;
        }
        
        return content.substring(match.index, index);
    }
    
    return null;
}

// Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø³ÙŠØ§Ù‚ Ø§Ù„Ø§Ø³ØªØ¯Ø¹Ø§Ø¡
function extractCallContext(content, callIndex) {
    const start = Math.max(0, callIndex - 50);
    const end = Math.min(content.length, callIndex + 50);
    return content.substring(start, end).replace(/\n/g, ' ').trim();
}

// Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…Ø­Ø¬ÙˆØ²Ø©
function isReservedKeyword(word) {
    const reserved = ['if', 'for', 'while', 'switch', 'case', 'return', 'break', 'continue', 'var', 'let', 'const', 'function', 'class'];
    return reserved.includes(word);
}

// ØªØ­Ù„ÙŠÙ„ ØªØ¨Ø¹ÙŠØ§Øª HTML
function analyzeHTMLDependencies(filePath, content) {
    const dependencies = [];
    
    // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø±ÙˆØ§Ø¨Ø· CSS
    const cssLinks = content.match(/<link[^>]*href="([^"]*\.css)[^>]*>/g) || [];
    cssLinks.forEach(link => {
        const href = link.match(/href="([^"]*)"/)[1];
        dependencies.push({ type: 'css', file: href, relation: 'stylesheet' });
    });
    
    // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø³ÙƒØ±ÙŠØ¨ØªØ§Øª JS
    const jsScripts = content.match(/<script[^>]*src="([^"]*\.js)[^>]*>/g) || [];
    jsScripts.forEach(script => {
        const src = script.match(/src="([^"]*)"/)[1];
        dependencies.push({ type: 'js', file: src, relation: 'script' });
    });
    
    // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† ØµÙˆØ±
    const images = content.match(/<img[^>]*src="([^"]*\.(?:png|jpg|jpeg|gif|svg))[^>]*>/g) || [];
    images.forEach(img => {
        const src = img.match(/src="([^"]*)"/)[1];
        dependencies.push({ type: 'image', file: src, relation: 'image' });
    });
    
    fileAnalysis[filePath].dependencies = dependencies;
}

// ØªØ­Ù„ÙŠÙ„ ØªØ¨Ø¹ÙŠØ§Øª CSS
function analyzeCSSDependencies(filePath, content) {
    const dependencies = [];
    
    // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ø³ØªÙŠØ±Ø§Ø¯Ø§Øª CSS
    const imports = content.match(/@import\s+url\(['"]?([^'")]*)['"]?\)/g) || [];
    imports.forEach(imp => {
        const url = imp.match(/@import\s+url\(['"]?([^'")]*)['"]?\)/)[1];
        dependencies.push({ type: 'css', file: url, relation: 'import' });
    });
    
    fileAnalysis[filePath].dependencies = dependencies;
}

// Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ù…Ù„ÙØ§Øª
function searchFiles() {
    const searchTerm = document.getElementById("fileSearchInput").value.trim();
    if (!searchTerm) {
        alert('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù…ØµØ·Ù„Ø­ Ø§Ù„Ø¨Ø­Ø«');
        return;
    }
    
    const results = performFileSearch(searchTerm);
    displayFileSearchResults(results, searchTerm);
}

// ØªÙ†ÙÙŠØ° Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ù…Ù„ÙØ§Øª
function performFileSearch(searchTerm) {
    const results = {
        exactMatches: [],
        partialMatches: [],
        extensionMatches: [],
        dependencyMatches: []
    };
    
    Object.keys(fileAnalysis).forEach(filePath => {
        const fileName = filePath.split('/').pop();
        
        // Ù…Ø·Ø§Ø¨Ù‚Ø© ØªØ§Ù…Ø©
        if (fileName === searchTerm || filePath === searchTerm) {
            results.exactMatches.push(filePath);
        }
        
        // Ù…Ø·Ø§Ø¨Ù‚Ø© Ø¬Ø²Ø¦ÙŠØ©
        if (fileName.includes(searchTerm) || filePath.includes(searchTerm)) {
            results.partialMatches.push(filePath);
        }
        
        // Ù…Ø·Ø§Ø¨Ù‚Ø© Ø§Ù„Ø§Ù…ØªØ¯Ø§Ø¯
        if (searchTerm.startsWith('.') && fileName.endsWith(searchTerm)) {
            results.extensionMatches.push(filePath);
        }
        
        // Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø§Ù„ØªØ¨Ø¹ÙŠØ§Øª
        const fileDeps = fileAnalysis[filePath].dependencies || [];
        const hasDependency = fileDeps.some(dep => 
            dep.file.includes(searchTerm) || dep.type.includes(searchTerm)
        );
        
        if (hasDependency) {
            results.dependencyMatches.push(filePath);
        }
    });
    
    // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„ØªÙƒØ±Ø§Ø±Ø§Øª
    results.partialMatches = results.partialMatches.filter(file => !results.exactMatches.includes(file));
    results.extensionMatches = results.extensionMatches.filter(file => !results.exactMatches.includes(file) && !results.partialMatches.includes(file));
    results.dependencyMatches = results.dependencyMatches.filter(file => !results.exactMatches.includes(file) && !results.partialMatches.includes(file) && !results.extensionMatches.includes(file));
    
    return results;
}

// Ø¹Ø±Ø¶ Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ù…Ù„ÙØ§Øª
function displayFileSearchResults(results, searchTerm) {
    const container = document.getElementById("fileSearchResults");
    let html = `<h4>Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø¨Ø­Ø« Ø¹Ù†: "${searchTerm}"</h4>`;
    
    if (results.exactMatches.length === 0 && results.partialMatches.length === 0 && 
        results.extensionMatches.length === 0 && results.dependencyMatches.length === 0) {
        html += `<p>âŒ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ù†ØªØ§Ø¦Ø¬ Ù…Ø·Ø§Ø¨Ù‚Ø©</p>`;
    } else {
        // Ø§Ù„Ù…Ø·Ø§Ø¨Ù‚Ø§Øª Ø§Ù„ØªØ§Ù…Ø©
        if (results.exactMatches.length > 0) {
            html += `<div class="search-result-item">
                <div class="search-result-header">âœ… Ù…Ø·Ø§Ø¨Ù‚Ø§Øª ØªØ§Ù…Ø©</div>
                <ul class="function-list">`;
            results.exactMatches.forEach(file => {
                html += `<li onclick="openFile('${file}')" style="cursor: pointer;">ğŸ“„ ${file}</li>`;
            });
            html += `</ul></div>`;
        }
        
        // Ø§Ù„Ù…Ø·Ø§Ø¨Ù‚Ø§Øª Ø§Ù„Ø¬Ø²Ø¦ÙŠØ©
        if (results.partialMatches.length > 0) {
            html += `<div class="search-result-item">
                <div class="search-result-header">ğŸ” Ù…Ø·Ø§Ø¨Ù‚Ø§Øª Ø¬Ø²Ø¦ÙŠØ©</div>
                <ul class="function-list">`;
            results.partialMatches.forEach(file => {
                html += `<li onclick="openFile('${file}')" style="cursor: pointer;">ğŸ“„ ${file}</li>`;
            });
            html += `</ul></div>`;
        }
        
        // Ù…Ø·Ø§Ø¨Ù‚Ø§Øª Ø§Ù„Ø§Ù…ØªØ¯Ø§Ø¯
        if (results.extensionMatches.length > 0) {
            html += `<div class="search-result-item">
                <div class="search-result-header">ğŸ“ Ù…Ù„ÙØ§Øª Ø¨Ø§Ù„Ø§Ù…ØªØ¯Ø§Ø¯ ${searchTerm}</div>
                <ul class="function-list">`;
            results.extensionMatches.forEach(file => {
                html += `<li onclick="openFile('${file}')" style="cursor: pointer;">ğŸ“„ ${file}</li>`;
            });
            html += `</ul></div>`;
        }
        
        // Ù…Ø·Ø§Ø¨Ù‚Ø§Øª Ø§Ù„ØªØ¨Ø¹ÙŠØ§Øª
        if (results.dependencyMatches.length > 0) {
            html += `<div class="search-result-item">
                <div class="search-result-header">ğŸ”— Ù…Ù„ÙØ§Øª ØªØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ ØªØ¨Ø¹ÙŠØ§Øª Ù…Ø±ØªØ¨Ø·Ø©</div>
                <ul class="function-list">`;
            results.dependencyMatches.forEach(file => {
                html += `<li onclick="openFile('${file}')" style="cursor: pointer;">ğŸ“„ ${file}</li>`;
            });
            html += `</ul></div>`;
        }
        
        // ØªØ­Ù„ÙŠÙ„ Ù…ÙØµÙ„ Ù„Ù„Ù†ØªÙŠØ¬Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰
        const firstResult = results.exactMatches[0] || results.partialMatches[0] || results.extensionMatches[0] || results.dependencyMatches[0];
        if (firstResult) {
            html += generateFileDetailedAnalysis(firstResult);
        }
    }
    
    container.innerHTML = html;
    container.style.display = 'block';
}

// Ø¥Ù†Ø´Ø§Ø¡ ØªØ­Ù„ÙŠÙ„ Ù…ÙØµÙ„ Ù„Ù„Ù…Ù„Ù
function generateFileDetailedAnalysis(filePath) {
    const analysis = fileAnalysis[filePath];
    if (!analysis) return '';
    
    let html = `<div class="search-result-item">
        <div class="search-result-header">ğŸ“Š ØªØ­Ù„ÙŠÙ„ Ù…ÙØµÙ„ Ù„Ù€: ${filePath}</div>
        <div class="search-result-content">`;
    
    // Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
    html += `<p><strong>Ù†ÙˆØ¹ Ø§Ù„Ù…Ù„Ù:</strong> ${analysis.type}</p>`;
    html += `<p><strong>Ø§Ù„Ø­Ø¬Ù…:</strong> ${analysis.size} Ø­Ø±Ù</p>`;
    html += `<p><strong>Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø³Ø·Ø±:</strong> ${analysis.lines}</p>`;
    
    // Ø§Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯Ø© ÙÙŠ Ø§Ù„Ù…Ù„Ù (Ù„Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ø¨Ø±Ù…Ø¬ÙŠØ©)
    if (analysis.functions && analysis.functions.length > 0) {
        html += `<div class="search-result-header">ğŸ“ Ø§Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„Ù…Ø­Ø¯Ø¯Ø© ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ù…Ù„Ù:</div>
                <ul class="function-list">`;
        analysis.functions.forEach(func => {
            html += `<li onclick="searchFunctionByName('${func}')" style="cursor: pointer; color: var(--primary-color);">âš™ï¸ ${func}</li>`;
        });
        html += `</ul>`;
    }
    
    // Ø§Ù„ØªØ¨Ø¹ÙŠØ§Øª (Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„ØªÙŠ ÙŠØ¹ØªÙ…Ø¯ Ø¹Ù„ÙŠÙ‡Ø§ Ù‡Ø°Ø§ Ø§Ù„Ù…Ù„Ù)
    if (analysis.dependencies && analysis.dependencies.length > 0) {
        html += `<div class="search-result-header">ğŸ“¥ Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„ØªÙŠ ÙŠØ¹ØªÙ…Ø¯ Ø¹Ù„ÙŠÙ‡Ø§ Ù‡Ø°Ø§ Ø§Ù„Ù…Ù„Ù:</div>
                <ul class="dependency-list">`;
        analysis.dependencies.forEach(dep => {
            html += `<li>ğŸ”— ${dep.file} (${dep.type}) - ${dep.relation}</li>`;
        });
        html += `</ul>`;
    }
    
    // Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„ØªÙŠ ØªØ¹ØªÙ…Ø¯ Ø¹Ù„Ù‰ Ù‡Ø°Ø§ Ø§Ù„Ù…Ù„Ù
    const dependents = findFileDependents(filePath);
    if (dependents.length > 0) {
        html += `<div class="search-result-header">ğŸ“¤ Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„ØªÙŠ ØªØ¹ØªÙ…Ø¯ Ø¹Ù„Ù‰ Ù‡Ø°Ø§ Ø§Ù„Ù…Ù„Ù:</div>
                <ul class="relation-list">`;
        dependents.forEach(dep => {
            html += `<li onclick="openFile('${dep.file}')" style="cursor: pointer;">ğŸ“„ ${dep.file} (${dep.relation})</li>`;
        });
        html += `</ul>`;
    }
    
    html += `</div></div>`;
    return html;
}

// Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„ØªÙŠ ØªØ¹ØªÙ…Ø¯ Ø¹Ù„Ù‰ Ù…Ù„Ù Ù…Ø¹ÙŠÙ†
function findFileDependents(targetFile) {
    const dependents = [];
    const fileName = targetFile.split('/').pop();
    
    Object.keys(fileAnalysis).forEach(filePath => {
        const dependencies = fileAnalysis[filePath].dependencies || [];
        dependencies.forEach(dep => {
            if (dep.file.includes(fileName) || dep.file === targetFile) {
                dependents.push({
                    file: filePath,
                    relation: dep.relation
                });
            }
        });
    });
    
    return dependents;
}

// Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ø¯ÙˆØ§Ù„
function searchFunctions() {
    const searchTerm = document.getElementById("functionSearchInput").value.trim();
    if (!searchTerm) {
        alert('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„Ø¯Ø§Ù„Ø©');
        return;
    }
    
    const results = performFunctionSearch(searchTerm);
    displayFunctionSearchResults(results, searchTerm);
}

// Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø¯Ø§Ù„Ø© Ø¨Ø§Ù„Ø§Ø³Ù… (Ù„Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…Ù† Ø§Ù„Ø±ÙˆØ§Ø¨Ø·)
function searchFunctionByName(functionName) {
    document.getElementById("functionSearchInput").value = functionName;
    searchFunctions();
}

// ØªÙ†ÙÙŠØ° Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ø¯ÙˆØ§Ù„
function performFunctionSearch(searchTerm) {
    const results = {
        exactMatches: [],
        partialMatches: [],
        calls: [],
        dependencies: []
    };
    
    Object.keys(functionAnalysis).forEach(funcName => {
        // Ù…Ø·Ø§Ø¨Ù‚Ø© ØªØ§Ù…Ø©
        if (funcName === searchTerm) {
            results.exactMatches.push(funcName);
        }
        
        // Ù…Ø·Ø§Ø¨Ù‚Ø© Ø¬Ø²Ø¦ÙŠØ©
        if (funcName.includes(searchTerm)) {
            results.partialMatches.push(funcName);
        }
    });
    
    // Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø§Ø³ØªØ¯Ø¹Ø§Ø¡Ø§Øª Ø§Ù„Ø¯ÙˆØ§Ù„
    Object.keys(functionAnalysis).forEach(funcName => {
        const func = functionAnalysis[funcName];
        if (func.dependencies && func.dependencies.includes(searchTerm)) {
            results.calls.push(funcName);
        }
    });
    
    // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„ØªÙƒØ±Ø§Ø±Ø§Øª
    results.partialMatches = results.partialMatches.filter(func => !results.exactMatches.includes(func));
    results.calls = results.calls.filter(func => !results.exactMatches.includes(func) && !results.partialMatches.includes(func));
    
    return results;
}

// Ø¹Ø±Ø¶ Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ø¯ÙˆØ§Ù„
function displayFunctionSearchResults(results, searchTerm) {
    const container = document.getElementById("functionSearchResults");
    let html = `<h4>Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ø¯Ø§Ù„Ø©: "${searchTerm}"</h4>`;
    
    if (results.exactMatches.length === 0 && results.partialMatches.length === 0 && results.calls.length === 0) {
        html += `<p>âŒ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø¯ÙˆØ§Ù„ Ù…Ø·Ø§Ø¨Ù‚Ø©</p>`;
    } else {
        // Ø§Ù„Ù…Ø·Ø§Ø¨Ù‚Ø§Øª Ø§Ù„ØªØ§Ù…Ø©
        if (results.exactMatches.length > 0) {
            html += `<div class="search-result-item">
                <div class="search-result-header">âœ… Ù…Ø·Ø§Ø¨Ù‚Ø§Øª ØªØ§Ù…Ø© Ù„Ù„Ø¯ÙˆØ§Ù„</div>
                <ul class="function-list">`;
            results.exactMatches.forEach(func => {
                html += `<li onclick="showFunctionDetails('${func}')" style="cursor: pointer;">âš™ï¸ ${func}</li>`;
            });
            html += `</ul></div>`;
        }
        
        // Ø§Ù„Ù…Ø·Ø§Ø¨Ù‚Ø§Øª Ø§Ù„Ø¬Ø²Ø¦ÙŠØ©
        if (results.partialMatches.length > 0) {
            html += `<div class="search-result-item">
                <div class="search-result-header">ğŸ” Ù…Ø·Ø§Ø¨Ù‚Ø§Øª Ø¬Ø²Ø¦ÙŠØ© Ù„Ù„Ø¯ÙˆØ§Ù„</div>
                <ul class="function-list">`;
            results.partialMatches.forEach(func => {
                html += `<li onclick="showFunctionDetails('${func}')" style="cursor: pointer;">âš™ï¸ ${func}</li>`;
            });
            html += `</ul></div>`;
        }
        
        // Ø§Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„ØªÙŠ ØªØ³ØªØ¯Ø¹ÙŠ Ø§Ù„Ø¯Ø§Ù„Ø© Ø§Ù„Ù…Ø¨Ø­ÙˆØ« Ø¹Ù†Ù‡Ø§
        if (results.calls.length > 0) {
            html += `<div class="search-result-item">
                <div class="search-result-header">ğŸ”„ Ø§Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„ØªÙŠ ØªØ³ØªØ¯Ø¹ÙŠ "${searchTerm}"</div>
                <ul class="function-list">`;
            results.calls.forEach(func => {
                html += `<li onclick="showFunctionDetails('${func}')" style="cursor: pointer;">âš™ï¸ ${func}</li>`;
            });
            html += `</ul></div>`;
        }
        
        // ØªØ­Ù„ÙŠÙ„ Ù…ÙØµÙ„ Ù„Ù„Ù†ØªÙŠØ¬Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰
        const firstResult = results.exactMatches[0] || results.partialMatches[0] || results.calls[0];
        if (firstResult) {
            html += generateFunctionDetailedAnalysis(firstResult);
        }
    }
    
    container.innerHTML = html;
    container.style.display = 'block';
}

// Ø¥Ù†Ø´Ø§Ø¡ ØªØ­Ù„ÙŠÙ„ Ù…ÙØµÙ„ Ù„Ù„Ø¯Ø§Ù„Ø©
function generateFunctionDetailedAnalysis(functionName) {
    const analysis = functionAnalysis[functionName];
    if (!analysis) return '';
    
    let html = `<div class="search-result-item">
        <div class="search-result-header">ğŸ“Š ØªØ­Ù„ÙŠÙ„ Ù…ÙØµÙ„ Ù„Ù„Ø¯Ø§Ù„Ø©: ${functionName}</div>
        <div class="search-result-content">`;
    
    // Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
    html += `<p><strong>Ø§Ù„Ù…Ù„Ù:</strong> <span onclick="openFile('${analysis.file}')" style="cursor: pointer; color: var(--primary-color);">ğŸ“„ ${analysis.file}</span></p>`;
    
    // Ø§Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„ØªÙŠ ØªØ¹ØªÙ…Ø¯ Ø¹Ù„ÙŠÙ‡Ø§ Ù‡Ø°Ù‡ Ø§Ù„Ø¯Ø§Ù„Ø©
    if (analysis.dependencies && analysis.dependencies.length > 0) {
        html += `<div class="search-result-header">ğŸ“¥ Ø§Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„ØªÙŠ ØªØ¹ØªÙ…Ø¯ Ø¹Ù„ÙŠÙ‡Ø§ Ù‡Ø°Ù‡ Ø§Ù„Ø¯Ø§Ù„Ø©:</div>
                <ul class="dependency-list">`;
        analysis.dependencies.forEach(dep => {
            html += `<li onclick="searchFunctionByName('${dep}')" style="cursor: pointer; color: var(--warning-color);">ğŸ”— ${dep}</li>`;
        });
        html += `</ul>`;
    }
    
    // Ø§Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„ØªÙŠ ØªØ¹ØªÙ…Ø¯ Ø¹Ù„Ù‰ Ù‡Ø°Ù‡ Ø§Ù„Ø¯Ø§Ù„Ø©
    const dependents = findFunctionDependents(functionName);
    if (dependents.length > 0) {
        html += `<div class="search-result-header">ğŸ“¤ Ø§Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„ØªÙŠ ØªØ¹ØªÙ…Ø¯ Ø¹Ù„Ù‰ Ù‡Ø°Ù‡ Ø§Ù„Ø¯Ø§Ù„Ø©:</div>
                <ul class="relation-list">`;
        dependents.forEach(dep => {
            html += `<li onclick="searchFunctionByName('${dep}')" style="cursor: pointer; color: var(--primary-color);">ğŸ”„ ${dep}</li>`;
        });
        html += `</ul>`;
    }
    
    // Ø§Ø³ØªØ¯Ø¹Ø§Ø¡Ø§Øª Ø§Ù„Ø¯Ø§Ù„Ø©
    if (analysis.calls && analysis.calls.length > 0) {
        html += `<div class="search-result-header">ğŸ“ Ø£Ù…Ø§ÙƒÙ† Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ Ø§Ù„Ø¯Ø§Ù„Ø©:</div>
                <ul class="function-list">`;
        analysis.calls.forEach(call => {
            html += `<li>ğŸ“ Ø§Ù„Ø³Ø·Ø± ${call.line}: ${call.context}</li>`;
        });
        html += `</ul>`;
    }
    
    // ØªØ¹Ø±ÙŠÙ Ø§Ù„Ø¯Ø§Ù„Ø©
    if (analysis.definition) {
        html += `<div class="search-result-header">ğŸ“‹ ØªØ¹Ø±ÙŠÙ Ø§Ù„Ø¯Ø§Ù„Ø©:</div>
                <div style="background: #f8f9fa; padding: 10px; border-radius: 4px; font-family: 'Courier New', monospace; direction: ltr;">
                    ${analysis.definition}
                </div>`;
    }
    
    html += `</div></div>`;
    return html;
}

// Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„ØªÙŠ ØªØ¹ØªÙ…Ø¯ Ø¹Ù„Ù‰ Ø¯Ø§Ù„Ø© Ù…Ø¹ÙŠÙ†Ø©
function findFunctionDependents(targetFunction) {
    const dependents = [];
    
    Object.keys(functionAnalysis).forEach(funcName => {
        const func = functionAnalysis[funcName];
        if (func.dependencies && func.dependencies.includes(targetFunction)) {
            dependents.push(funcName);
        }
    });
    
    return dependents;
}

// Ø¹Ø±Ø¶ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø¯Ø§Ù„Ø©
function showFunctionDetails(functionName) {
    const analysis = functionAnalysis[functionName];
    if (!analysis) return;
    
    // ÙØªØ­ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø°ÙŠ ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø§Ù„Ø¯Ø§Ù„Ø©
    openFile(analysis.file);
    
    // Ø¥Ø¸Ù‡Ø§Ø± ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¯Ø§Ù„Ø© ÙÙŠ Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø¨Ø­Ø«
    document.getElementById("functionSearchInput").value = functionName;
    const container = document.getElementById("functionSearchResults");
    container.innerHTML = `<h4>ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø¯Ø§Ù„Ø©: ${functionName}</h4>` + generateFunctionDetailedAnalysis(functionName);
    container.style.display = 'block';
}

// Ù…Ø³Ø­ Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ù…Ù„ÙØ§Øª
function clearFileSearch() {
    document.getElementById("fileSearchInput").value = '';
    document.getElementById("fileSearchResults").style.display = 'none';
}

// Ù…Ø³Ø­ Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ø¯ÙˆØ§Ù„
function clearFunctionSearch() {
    document.getElementById("functionSearchInput").value = '';
    document.getElementById("functionSearchResults").style.display = 'none';
}

// =============================================================================
// Ø§Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„Ø£ØµÙ„ÙŠØ© Ù…Ù† Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø³Ø§Ø¨Ù‚ (Ø¨Ø¯ÙˆÙ† ØªØºÙŠÙŠØ±)
// =============================================================================

// ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª Ø¨ÙŠÙ† Ø§Ù„Ù…Ù„ÙØ§Øª
function analyzeFileRelations(filePath, fileType, content) {
    switch(fileType) {
        case "html":
            analyzeHTMLRelations(filePath, content);
            break;
        case "css":
            analyzeCSSRelations(filePath, content);
            break;
        case "js":
            analyzeJSRelations(filePath, content);
            break;
        case "json":
            analyzeJSONRelations(filePath, content);
            break;
    }
}

// ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª ÙÙŠ Ù…Ù„ÙØ§Øª HTML
function analyzeHTMLRelations(filePath, content) {
    // Ø§ÙƒØªØ´Ø§Ù Ø§Ø³ØªØ¯Ø¹Ø§Ø¡Ø§Øª CSS
    const cssLinks = content.match(/<link[^>]*href="([^"]*\.css)[^>]*>/g) || [];
    cssLinks.forEach(link => {
        const href = link.match(/href="([^"]*)"/)[1];
        if (!dependencyMap.htmlToCss[filePath]) {
            dependencyMap.htmlToCss[filePath] = [];
        }
        dependencyMap.htmlToCss[filePath].push(href);
    });
    
    // Ø§ÙƒØªØ´Ø§Ù Ø§Ø³ØªØ¯Ø¹Ø§Ø¡Ø§Øª JS
    const jsScripts = content.match(/<script[^>]*src="([^"]*\.js)[^>]*>/g) || [];
    jsScripts.forEach(script => {
        const src = script.match(/src="([^"]*)"/)[1];
        if (!dependencyMap.htmlToJs[filePath]) {
            dependencyMap.htmlToJs[filePath] = [];
        }
        dependencyMap.htmlToJs[filePath].push(src);
    });
    
    // Ø§ÙƒØªØ´Ø§Ù Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø°Ø§Øª Ø§Ù„Ø£ÙŠØ¯ÙŠ (IDs) ÙˆØ§Ù„ÙØ¦Ø§Øª (Classes)
    const elementsWithIds = content.match(/id="([^"]*)"/g) || [];
    const elementsWithClasses = content.match(/class="([^"]*)"/g) || [];
    
    if (elementsWithIds.length > 0 || elementsWithClasses.length > 0) {
        projectStructure.components[filePath] = {
            ids: elementsWithIds.map(id => id.match(/id="([^"]*)"/)[1]),
            classes: elementsWithClasses.map(cls => cls.match(/class="([^"]*)"/)[1].split(' ')).flat()
        };
    }
    
    // ØªØ­Ø¯ÙŠØ¯ Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…Ù„Ù Ø¯Ø®ÙˆÙ„ Ø±Ø¦ÙŠØ³ÙŠ
    if (filePath.includes('index') || filePath.includes('main')) {
        projectStructure.entryPoints.push(filePath);
    }
}

// ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª ÙÙŠ Ù…Ù„ÙØ§Øª CSS
function analyzeCSSRelations(filePath, content) {
    // Ø§ÙƒØªØ´Ø§Ù Ø§Ø³ØªØ¯Ø¹Ø§Ø¡Ø§Øª CSS Ø§Ù„Ø£Ø®Ø±Ù‰
    const imports = content.match(/@import\s+url\(['"]?([^'")]*)['"]?\)/g) || [];
    imports.forEach(imp => {
        const url = imp.match(/@import\s+url\(['"]?([^'")]*)['"]?\)/)[1];
        if (!dependencyMap.cssToJs[filePath]) {
            dependencyMap.cssToJs[filePath] = [];
        }
        dependencyMap.cssToJs[filePath].push(url);
    });
    
    // ØªØ­Ù„ÙŠÙ„ Ø§Ù„ÙØ¦Ø§Øª ÙˆØ§Ù„Ø£ÙŠØ¯ÙŠ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©
    const classes = content.match(/\.([a-zA-Z0-9_-]+)/g) || [];
    const ids = content.match(/#([a-zA-Z0-9_-]+)/g) || [];
    
    if (classes.length > 0 || ids.length > 0) {
        projectStructure.components[filePath] = {
            classes: [...new Set(classes.map(c => c.substring(1)))],
            ids: [...new Set(ids.map(id => id.substring(1)))]
        };
    }
}

// ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª ÙÙŠ Ù…Ù„ÙØ§Øª JavaScript
function analyzeJSRelations(filePath, content) {
    // Ø§ÙƒØªØ´Ø§Ù Ø§Ø³ØªØ¯Ø¹Ø§Ø¡Ø§Øª JSON
    const jsonImports = content.match(/fetch\(['"]([^'"]*\.json)['"]\)|import\s+.*from\s+['"]([^'"]*\.json)['"]/g) || [];
    jsonImports.forEach(imp => {
        const match = imp.match(/['"]([^'"]*\.json)['"]/);
        if (match) {
            if (!dependencyMap.jsToJson[filePath]) {
                dependencyMap.jsToJson[filePath] = [];
            }
            dependencyMap.jsToJson[filePath].push(match[1]);
        }
    });
    
    // Ø§ÙƒØªØ´Ø§Ù Ø§Ù„ØªÙ„Ø§Ø¹Ø¨ Ø¨Ø§Ù„Ù€ DOM
    const domSelectors = content.match(/document\.(querySelector|getElementById|getElementsByClassName)\(['"]([^'"]*)['"]\)/g) || [];
    domSelectors.forEach(selector => {
        const match = selector.match(/\(['"]([^'"]*)['"]\)/);
        if (match) {
            if (!dependencyMap.jsToHtml[filePath]) {
                dependencyMap.jsToHtml[filePath] = [];
            }
            dependencyMap.jsToHtml[filePath].push(match[1]);
        }
    });
    
    // Ø§ÙƒØªØ´Ø§Ù Ø§Ù„ÙˆØ¸Ø§Ø¦Ù ÙˆØ§Ù„Ù…ØªØºÙŠØ±Ø§Øª
    const functions = content.match(/(function\s+(\w+)|const\s+(\w+)\s*=\s*\(|let\s+(\w+)\s*=\s*\(|var\s+(\w+)\s*=\s*\()/g) || [];
    if (functions.length > 0) {
        projectStructure.modules[filePath] = {
            functions: functions.map(f => {
                const match = f.match(/(function\s+(\w+)|const\s+(\w+)|let\s+(\w+)|var\s+(\w+))/);
                return match[2] || match[3] || match[4] || match[5];
            })
        };
    }
    
    // Ø§ÙƒØªØ´Ø§Ù Ø§Ø³ØªØ¯Ø¹Ø§Ø¡Ø§Øª APIs
    const apiCalls = content.match(/(fetch|axios|XMLHttpRequest)\(['"]([^'"]*)['"]\)/g) || [];
    if (apiCalls.length > 0) {
        projectStructure.dataFlows.push({
            file: filePath,
            apis: apiCalls.map(api => {
                const match = api.match(/\(['"]([^'"]*)['"]\)/);
                return match ? match[1] : 'unknown';
            })
        });
    }
}

// ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª ÙÙŠ Ù…Ù„ÙØ§Øª JSON
function analyzeJSONRelations(filePath, content) {
    try {
        const data = JSON.parse(content);
        
        // ØªØ­Ù„ÙŠÙ„ Ù‡ÙŠÙƒÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        projectStructure.architecture[filePath] = {
            type: determineJSONType(data),
            structure: analyzeJSONStructure(data),
            size: Object.keys(data).length
        };
    } catch(e) {
        // ÙÙŠ Ø­Ø§Ù„Ø© Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù„ÙŠÙ„ JSON
        console.error(`Error parsing JSON file ${filePath}:`, e);
    }
}

// ØªØ­Ø¯ÙŠØ¯ Ù†ÙˆØ¹ Ù…Ù„Ù JSON
function determineJSONType(data) {
    if (data.dependencies || data.devDependencies) return 'package';
    if (data.name && data.version) return 'config';
    if (Array.isArray(data)) return 'array-data';
    if (typeof data === 'object') {
        if (Object.keys(data).every(key => typeof data[key] === 'string')) return 'key-value';
        return 'complex-object';
    }
    return 'unknown';
}

// ØªØ­Ù„ÙŠÙ„ Ù‡ÙŠÙƒÙ„ JSON
function analyzeJSONStructure(obj, depth = 0) {
    if (depth > 3) return 'deep-structure';
    
    const structure = {};
    for (let key in obj) {
        if (typeof obj[key] === 'object' && obj[key] !== null) {
            if (Array.isArray(obj[key])) {
                structure[key] = `array[${obj[key].length}]`;
                if (obj[key].length > 0 && typeof obj[key][0] === 'object') {
                    structure[key] += ` of ${analyzeJSONStructure(obj[key][0], depth + 1)}`;
                }
            } else {
                structure[key] = analyzeJSONStructure(obj[key], depth + 1);
            }
        } else {
            structure[key] = typeof obj[key];
        }
    }
    return structure;
}

// ØªØ­Ø¯ÙŠØ« Ø¹Ø±Ø¶ Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª
function updateRelationsView() {
    let relationsHTML = '<div class="relations-container">';
    
    // Ø¥Ø­ØµØ§Ø¡ Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª
    let relationCount = 0;
    
    // Ø¹Ø±Ø¶ Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª Ù…Ù† HTML Ø¥Ù„Ù‰ CSS
    if (Object.keys(dependencyMap.htmlToCss).length > 0) {
        relationsHTML += '<h4>ğŸ”— Ø¹Ù„Ø§Ù‚Ø§Øª HTML â†’ CSS:</h4>';
        for (let htmlFile in dependencyMap.htmlToCss) {
            relationsHTML += `<div class="relation-item">${htmlFile} â†’ ${dependencyMap.htmlToCss[htmlFile].join(', ')}</div>`;
            relationCount += dependencyMap.htmlToCss[htmlFile].length;
        }
    }
    
    // Ø¹Ø±Ø¶ Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª Ù…Ù† HTML Ø¥Ù„Ù‰ JS
    if (Object.keys(dependencyMap.htmlToJs).length > 0) {
        relationsHTML += '<h4>ğŸ”— Ø¹Ù„Ø§Ù‚Ø§Øª HTML â†’ JavaScript:</h4>';
        for (let htmlFile in dependencyMap.htmlToJs) {
            relationsHTML += `<div class="relation-item">${htmlFile} â†’ ${dependencyMap.htmlToJs[htmlFile].join(', ')}</div>`;
            relationCount += dependencyMap.htmlToJs[htmlFile].length;
        }
    }
    
    // Ø¹Ø±Ø¶ Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª Ù…Ù† JS Ø¥Ù„Ù‰ JSON
    if (Object.keys(dependencyMap.jsToJson).length > 0) {
        relationsHTML += '<h4>ğŸ”— Ø¹Ù„Ø§Ù‚Ø§Øª JavaScript â†’ JSON:</h4>';
        for (let jsFile in dependencyMap.jsToJson) {
            relationsHTML += `<div class="relation-item">${jsFile} â†’ ${dependencyMap.jsToJson[jsFile].join(', ')}</div>`;
            relationCount += dependencyMap.jsToJson[jsFile].length;
        }
    }
    
    // Ø¹Ø±Ø¶ Ù†Ù‚Ø§Ø· Ø§Ù„Ø¯Ø®ÙˆÙ„
    if (projectStructure.entryPoints.length > 0) {
        relationsHTML += '<h4>ğŸšª Ù†Ù‚Ø§Ø· Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©:</h4>';
        projectStructure.entryPoints.forEach(entry => {
            relationsHTML += `<div class="relation-item">${entry}</div>`;
        });
    }
    
    relationsHTML += '</div>';
    document.getElementById("relationsView").innerHTML = relationsHTML;
    document.getElementById("relationCount").innerText = relationCount;
}

// Ø¥Ù†Ø´Ø§Ø¡ ÙˆØµÙ ØªÙØµÙŠÙ„ÙŠ Ù„Ù„Ù…Ù„Ù
function generateFileDescription(name, fullPath, fileType, content) {
    let description = "";
    
    switch(fileType) {
        case "css":
            description = `Ù…Ù„Ù Ø£Ù†Ù…Ø§Ø· CSS - ${getCSSRole(name)} - ${getCSSTargets(name)}`;
            if (content.includes('@media')) description += " - ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø§Ø³ØªØ¹Ù„Ø§Ù…Ø§Øª ÙˆØ³Ø§Ø¦Ø· Ù„Ù„ØªØµÙ…ÙŠÙ… Ø§Ù„Ù…ØªØ¬Ø§ÙˆØ¨";
            if (content.includes('animation') || content.includes('@keyframes')) description += " - ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø­Ø±ÙƒØ§Øª ÙˆØªÙØ§Ø¹Ù„Ø§Øª";
            break;
            
        case "html":
            description = `Ù…Ù„Ù Ù‡ÙŠÙƒÙ„ HTML - ${getHTMLPageType(name)} - ${getHTMLComponents(name)}`;
            if (content.includes('<form')) description += " - ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ù†Ù…Ø§Ø°Ø¬ Ø¥Ø¯Ø®Ø§Ù„";
            if (content.includes('<script')) description += " - ÙŠØªØ¶Ù…Ù† Ø£ÙƒÙˆØ§Ø¯ JavaScript";
            if (content.includes('<link rel="stylesheet"')) description += " - ÙŠØ³ØªØ¯Ø¹ÙŠ Ù…Ù„ÙØ§Øª Ø£Ù†Ù…Ø§Ø· Ø®Ø§Ø±Ø¬ÙŠØ©";
            break;
            
        case "js":
            description = `Ù…Ù„Ù JavaScript - ${getJSPattern(name)} - ${getJSFunctions(name)}`;
            if (content.includes('function')) description += ` - ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ ${countFunctions(content)} ÙˆØ¸ÙŠÙØ©`;
            if (content.includes('addEventListener')) description += " - ÙŠØ¹Ø§Ù„Ø¬ Ø£Ø­Ø¯Ø§Ø« Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…";
            if (content.includes('fetch') || content.includes('ajax')) description += " - ÙŠØªÙˆØ§ØµÙ„ Ù…Ø¹ APIs Ø®Ø§Ø±Ø¬ÙŠØ©";
            if (content.includes('import') || content.includes('require')) description += " - ÙŠØ³ØªØ¯Ø¹ÙŠ ÙˆØ­Ø¯Ø§Øª Ø®Ø§Ø±Ø¬ÙŠØ©";
            break;
            
        case "json":
            description = `Ù…Ù„Ù Ø¨ÙŠØ§Ù†Ø§Øª JSON - ${getJSONDataType(name)} - ${getJSONStructure(content)}`;
            try {
                const data = JSON.parse(content);
                description += ` - ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ ${Object.keys(data).length} Ø®Ø§ØµÙŠØ© Ø±Ø¦ÙŠØ³ÙŠØ©`;
            } catch(e) {}
            break;
            
        default:
            description = `Ù…Ù„Ù ${getOtherFileType(name)} - ${getOtherFileRole(name)} - ${getOtherFileImportance(name)}`;
    }
    
    return description;
}

// ØªØ­Ø¯ÙŠØ¯ Ù†ÙˆØ¹ Ø§Ù„Ù…Ù„Ù Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ø§Ù…ØªØ¯Ø§Ø¯
function getFileType(filename) {
    if (filename.endsWith(".css")) return "css";
    if (filename.endsWith(".html") || filename.endsWith(".htm")) return "html";
    if (filename.endsWith(".js")) return "js";
    if (filename.endsWith(".json")) return "json";
    return "other";
}

// Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø£ÙŠÙ‚ÙˆÙ†Ø© Ù…Ù†Ø§Ø³Ø¨Ø© Ù„Ù†ÙˆØ¹ Ø§Ù„Ù…Ù„Ù
function getFileIcon(fileType) {
    const icons = {
        css: "ğŸ¨",
        html: "ğŸŒ",
        js: "âš™ï¸",
        json: "ğŸ“‹",
        other: "ğŸ“„"
    };
    return icons[fileType] || "ğŸ“„";
}

// ÙØªØ­ Ù…Ù„Ù Ø¯Ø§Ø®Ù„ Ù†Ø§ÙØ°Ø©
function openFile(filePath) {
    let allText = document.getElementById("output").value;

    let start = allText.indexOf(`Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ù…Ù„Ù: ${filePath}`);
    if (start === -1) return;

    let end = allText.indexOf(`Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ù…Ù„Ù: ${filePath}`);
    let content = allText.substring(start, end + `Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ù…Ù„Ù: ${filePath}`.length);

    document.getElementById("fileInfo").innerHTML = `
        <strong>Ø§Ø³Ù… Ø§Ù„Ù…Ù„Ù:</strong> ${filePath}<br>
        <strong>Ø§Ù„Ù†ÙˆØ¹:</strong> ${getFileType(filePath)}<br>
        <strong>Ø§Ù„ÙˆØµÙ:</strong> ${relations[getFileType(filePath)]?.[filePath] || 'Ù„Ø§ ÙŠÙˆØ¬Ø¯ ÙˆØµÙ'}<br>
        <strong>Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª:</strong> ${getFileRelationsSummary(filePath)}
    `;
    document.getElementById("fileContent").innerText = content;
    document.getElementById("modal").style.display = "flex";
}

// Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù…Ù„Ø®Øµ Ø¹Ù„Ø§Ù‚Ø§Øª Ø§Ù„Ù…Ù„Ù
function getFileRelationsSummary(filePath) {
    const fileType = getFileType(filePath);
    let relations = [];
    
    if (fileType === 'html') {
        if (dependencyMap.htmlToCss[filePath]) {
            relations.push(`ÙŠØ³ØªØ¯Ø¹ÙŠ ${dependencyMap.htmlToCss[filePath].length} Ù…Ù„Ù CSS`);
        }
        if (dependencyMap.htmlToJs[filePath]) {
            relations.push(`ÙŠØ³ØªØ¯Ø¹ÙŠ ${dependencyMap.htmlToJs[filePath].length} Ù…Ù„Ù JS`);
        }
    } else if (fileType === 'js') {
        if (dependencyMap.jsToJson[filePath]) {
            relations.push(`ÙŠØ³ØªØ¯Ø¹ÙŠ ${dependencyMap.jsToJson[filePath].length} Ù…Ù„Ù JSON`);
        }
        if (dependencyMap.jsToHtml[filePath]) {
            relations.push(`ÙŠØªÙØ§Ø¹Ù„ Ù…Ø¹ ${dependencyMap.jsToHtml[filePath].length} Ø¹Ù†ØµØ± HTML`);
        }
    }
    
    return relations.length > 0 ? relations.join('ØŒ ') : 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¹Ù„Ø§Ù‚Ø§Øª Ù…Ø­Ø¯Ø¯Ø©';
}

function closeModal() {
    document.getElementById("modal").style.display = "none";
}

// ÙØªØ­/Ø¥ØºÙ„Ø§Ù‚ Ù…Ø¬Ù„Ø¯ Ø´Ø¬Ø±ÙŠ
function toggleFolder(el) {
    let panel = el.nextElementSibling;
    panel.style.display = panel.style.display === "none" ? "block" : "none";
    
    // ØªØºÙŠÙŠØ± Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø©
    let icon = el.querySelector('span');
    if (panel.style.display === "block") {
        icon.textContent = "ğŸ“‚";
    } else {
        icon.textContent = "ğŸ“";
    }
}

// ØªØ¬Ø§Ù‡Ù„ Ø¹Ù†ØµØ±
function ignoreItem(event, name) {
    event.stopPropagation();
    let area = document.getElementById("ignoreList");
    if (!area.value.includes(name)) {
        area.value += `\n${name}`;
        localStorage.setItem("ignored", area.value);
    }
    readAll();
}

// Ø­ÙØ¸ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ØªØ¬Ø§Ù‡Ù„
function saveIgnore() {
    localStorage.setItem("ignored", document.getElementById("ignoreList").value);
    alert("ØªÙ… Ø­ÙØ¸ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ØªØ¬Ø§Ù‡Ù„ Ø¨Ù†Ø¬Ø§Ø­");
}

// Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ØªØ¬Ø§Ù‡Ù„
function resetIgnore() {
    if (confirm("Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ù‚Ù‹Ø§ Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ØªØ¬Ø§Ù‡Ù„ØŸ")) {
        document.getElementById("ignoreList").value = "node_modules\n.git\n.vscode\n.DS_Store\nThumbs.db";
        localStorage.setItem("ignored", document.getElementById("ignoreList").value);
        readAll();
    }
}

// ØªØµØ¯ÙŠØ± Ø­Ø³Ø¨ Ø§Ù„Ù†ÙˆØ¹ Ù…Ø¹ Ø´Ø±Ø­ Ù…ÙØµÙ„ Ù„Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ
function exportByType() {
    function generateDetailedContent(content, fileType, files) {
        let header = "";
        
        switch(fileType) {
            case "css":
                header = `/*
================================================================================
Ù…Ù„Ù ØªØ¬Ù…ÙŠØ¹ÙŠ Ù„Ø¬Ù…ÙŠØ¹ Ù…Ù„ÙØ§Øª CSS ÙÙŠ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹: ${projectName}
ØªÙ… Ø¥Ù†Ø´Ø§Ø¤Ù‡ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¨ÙˆØ§Ø³Ø·Ø© Ø£Ø¯Ø§Ø© ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹
ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡: ${new Date().toLocaleString('ar-EG')}
================================================================================

ğŸ“‹ Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø©:
-------------
Ù‡Ø°Ø§ Ø§Ù„Ù…Ù„Ù ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø¬Ù…ÙŠØ¹ Ø£Ù†Ù…Ø§Ø· CSS Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø© ÙÙŠ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹
ÙŠØ´Ù…Ù„ Ù…Ù„ÙØ§Øª Ø§Ù„ØªØµÙ…ÙŠÙ… Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©ØŒ Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨ÙŠØ©ØŒ ÙˆØ§Ù„Ù…ÙƒÙˆÙ†Ø§Øª

ğŸ”— Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª Ø¨ÙŠÙ† Ø§Ù„Ù…Ù„ÙØ§Øª:
------------------------
${generateDependencyAnalysis('css')}

ğŸ¯ Ø£Ø¯ÙˆØ§Ø± Ø§Ù„Ù…Ù„ÙØ§Øª:
----------------
${Object.keys(files).map(path => `
ğŸ“ ${path}:
   - Ø§Ù„ÙˆØ¸ÙŠÙØ©: ${files[path]}
   - Ø§Ù„ØªØ£Ø«ÙŠØ±: ${getCSSRole(path)}
   - Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª Ø§Ù„Ù…Ø³ØªÙ‡Ø¯ÙØ©: ${getCSSTargets(path)}
   - Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª: ${getCSSRelations(path)}
   - Ø§Ù„ÙØ¦Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©: ${projectStructure.components[path]?.classes?.join(', ') || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}
   - Ø§Ù„Ø£ÙŠØ¯ÙŠ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©: ${projectStructure.components[path]?.ids?.join(', ') || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}
`).join('')}

ğŸ“Š Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª:
-----------
- Ø¹Ø¯Ø¯ Ù…Ù„ÙØ§Øª CSS: ${Object.keys(files).length}
- Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£Ø³Ø·Ø±: ${countLines(content)}
- Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©: ${getMainCSSFiles(files)}
- Ù†Ø³Ø¨Ø© Ø§Ù„ØªÙƒØ±Ø§Ø±: ${calculateRepetitionRate(content)}

âš¡ Ø§Ù„ØªÙˆØµÙŠØ§Øª Ø§Ù„ÙÙ†ÙŠØ©:
------------------
${getCSSRecommendations(files)}

ğŸ” Ø§Ù„Ø£Ù†Ù…Ø§Ø· Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© Ø§Ù„Ù…ÙƒØªØ´ÙØ©:
--------------------------
${detectCSSPatterns(content)}

================================================================================
*/`;
                break;

            case "html":
                header = `<!--
================================================================================
Ù…Ù„Ù ØªØ¬Ù…ÙŠØ¹ÙŠ Ù„Ø¬Ù…ÙŠØ¹ Ù…Ù„ÙØ§Øª HTML ÙÙŠ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹: ${projectName}
ØªÙ… Ø¥Ù†Ø´Ø§Ø¤Ù‡ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¨ÙˆØ§Ø³Ø·Ø© Ø£Ø¯Ø§Ø© ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹  
ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡: ${new Date().toLocaleString('ar-EG')}
================================================================================

ğŸ“‹ Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø©:
-------------
Ù‡Ø°Ø§ Ø§Ù„Ù…Ù„Ù ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø¬Ù…ÙŠØ¹ Ù‡ÙŠÙƒÙ„ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ (HTML)
ÙŠØ´Ù…Ù„ Ø§Ù„ØµÙØ­Ø§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©ØŒ Ø§Ù„Ù…ÙƒÙˆÙ†Ø§ØªØŒ ÙˆØ§Ù„Ù‚ÙˆØ§Ù„Ø¨

ğŸ”— Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª Ø¨ÙŠÙ† Ø§Ù„Ù…Ù„ÙØ§Øª:
------------------------
${generateDependencyAnalysis('html')}

ğŸ¯ Ø£Ø¯ÙˆØ§Ø± Ø§Ù„Ù…Ù„ÙØ§Øª:
----------------
${Object.keys(files).map(path => `
ğŸ“ ${path}:
   - Ø§Ù„ÙˆØ¸ÙŠÙØ©: ${files[path]}
   - Ù†ÙˆØ¹ Ø§Ù„ØµÙØ­Ø©: ${getHTMLPageType(path)}
   - Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©: ${getHTMLComponents(path)}
   - Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø©: ${getHTMLLinkedFiles(path)}
   - Ø§Ù„Ù‡ÙŠÙƒÙ„: ${getHTMLStructureAnalysis(path)}
   - Ø§Ù„Ø£ÙŠØ¯ÙŠ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©: ${projectStructure.components[path]?.ids?.join(', ') || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}
   - Ø§Ù„ÙØ¦Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©: ${projectStructure.components[path]?.classes?.join(', ') || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}
`).join('')}

ğŸ“Š Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª:
-----------
- Ø¹Ø¯Ø¯ ØµÙØ­Ø§Øª HTML: ${Object.keys(files).length}
- Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¹Ù†Ø§ØµØ±: ${countHTMLElements(content)}
- Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª Ø§Ù„Ù…ØªÙƒØ±Ø±Ø©: ${getCommonComponents(files)}
- Ù†Ø³Ø¨Ø© Ø§Ù„ØªÙØ§Ø¹Ù„: ${calculateInteractivityRate(content)}

ğŸ—ï¸  Ø§Ù„Ù‡ÙŠÙƒÙ„ Ø§Ù„Ø¹Ø§Ù…:
--------------
${getHTMLStructure(files)}

ğŸ” Ø§Ù„Ø£Ù†Ù…Ø§Ø· Ø§Ù„Ù…Ø¹Ù…Ø§Ø±ÙŠØ©:
-------------------
${detectHTMLPatterns(content)}

================================================================================
-->`;
                break;

            case "js":
                header = `/*
================================================================================
Ù…Ù„Ù ØªØ¬Ù…ÙŠØ¹ÙŠ Ù„Ø¬Ù…ÙŠØ¹ Ù…Ù„ÙØ§Øª JavaScript ÙÙŠ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹: ${projectName}
ØªÙ… Ø¥Ù†Ø´Ø§Ø¤Ù‡ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¨ÙˆØ§Ø³Ø·Ø© Ø£Ø¯Ø§Ø© ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹
ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡: ${new Date().toLocaleString('ar-EG')}
================================================================================

ğŸ“‹ Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø©:
-------------
Ù‡Ø°Ø§ Ø§Ù„Ù…Ù„Ù ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø¬Ù…ÙŠØ¹ Ù…Ù†Ø·Ù‚ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ (JavaScript)
ÙŠØ´Ù…Ù„ Ø§Ù„ÙˆØ¸Ø§Ø¦ÙØŒ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø§ØªØŒ Ø§Ù„Ø§ØªØµØ§Ù„Ø§ØªØŒ ÙˆØ§Ù„ØªÙØ§Ø¹Ù„Ø§Øª

ğŸ”— Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª Ø¨ÙŠÙ† Ø§Ù„Ù…Ù„ÙØ§Øª:
------------------------
${generateDependencyAnalysis('js')}

ğŸ¯ Ø£Ø¯ÙˆØ§Ø± Ø§Ù„Ù…Ù„ÙØ§Øª:
----------------
${Object.keys(files).map(path => `
ğŸ“ ${path}:
   - Ø§Ù„ÙˆØ¸ÙŠÙØ©: ${files[path]}
   - Ø§Ù„Ù†Ù…Ø·: ${getJSPattern(path)}
   - Ø§Ù„ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©: ${getJSFunctions(path)}
   - Ø§Ù„ØªØ¨Ø¹ÙŠØ§Øª: ${getJSDependencies(path)}
   - Ø§Ù„ØªØ¹Ù‚ÙŠØ¯: ${calculateJSComplexity(path)}
   - Ø¹Ø¯Ø¯ Ø§Ù„ÙˆØ¸Ø§Ø¦Ù: ${projectStructure.modules[path]?.functions?.length || 0}
   - APIs Ø§Ù„Ù…Ø³ØªØ¯Ø¹Ø§Ø©: ${getJSAPIs(path)}
`).join('')}

ğŸ—ï¸  Ø§Ù„Ø£Ù†Ù…Ø§Ø· Ø§Ù„Ù…Ø¹Ù…Ø§Ø±ÙŠØ©:
--------------------
${getJSArchitecture(files)}

ğŸ“Š Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª:
-----------
- Ø¹Ø¯Ø¯ Ù…Ù„ÙØ§Øª JS: ${Object.keys(files).length}
- Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ÙˆØ¸Ø§Ø¦Ù: ${countJSFunctions(content)}
- Ø§Ù„Ù…ÙƒØªØ¨Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©: ${getJSLibraries(files)}
- Ù†Ø³Ø¨Ø© Ø§Ù„ØªÙØ§Ø¹Ù„: ${calculateJSInteractivity(content)}

âš¡ ØªØ¯ÙÙ‚ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:
---------------
${getJSDataFlow(files)}

ğŸ” Ø§Ù„Ø£Ù†Ù…Ø§Ø· Ø§Ù„Ø¨Ø±Ù…Ø¬ÙŠØ©:
------------------
${detectJSPatterns(content)}

================================================================================
*/`;
                break;

            case "json":
                header = `/*
================================================================================
Ù…Ù„Ù ØªØ¬Ù…ÙŠØ¹ÙŠ Ù„Ø¬Ù…ÙŠØ¹ Ù…Ù„ÙØ§Øª JSON ÙÙŠ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹: ${projectName}
ØªÙ… Ø¥Ù†Ø´Ø§Ø¤Ù‡ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¨ÙˆØ§Ø³Ø·Ø© Ø£Ø¯Ø§Ø© ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹
ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡: ${new Date().toLocaleString('ar-EG')}
================================================================================

ğŸ“‹ Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø©:
-------------
Ù‡Ø°Ø§ Ø§Ù„Ù…Ù„Ù ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø¬Ù…ÙŠØ¹ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ (JSON)
ÙŠØ´Ù…Ù„ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§ØªØŒ Ø§Ù„ØªÙ‡ÙŠØ¦Ø©ØŒ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø«Ø§Ø¨ØªØ©ØŒ ÙˆØ§Ù„ØªØ±Ø¬Ù…Ø©

ğŸ”— Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª Ø¨ÙŠÙ† Ø§Ù„Ù…Ù„ÙØ§Øª:
------------------------
${generateDependencyAnalysis('json')}

ğŸ¯ Ø£Ø¯ÙˆØ§Ø± Ø§Ù„Ù…Ù„ÙØ§Øª:
----------------
${Object.keys(files).map(path => `
ğŸ“ ${path}:
   - Ø§Ù„ÙˆØ¸ÙŠÙØ©: ${files[path]}
   - Ù†ÙˆØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª: ${getJSONDataType(path)}
   - Ø§Ù„Ù‡ÙŠÙƒÙ„: ${getJSONStructure(path)}
   - Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…: ${getJSONUsage(path)}
   - Ø§Ù„Ø­Ø¬Ù…: ${getJSONSize(path)}
   - Ø§Ù„ØªØ¹Ù‚ÙŠØ¯: ${projectStructure.architecture[path]?.type || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}
   - Ø¹Ø¯Ø¯ Ø§Ù„Ø®ØµØ§Ø¦Øµ: ${projectStructure.architecture[path]?.size || 0}
`).join('')}

ğŸ“Š Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª:
-----------
- Ø¹Ø¯Ø¯ Ù…Ù„ÙØ§Øª JSON: ${Object.keys(files).length}
- Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ù…ÙØ§ØªÙŠØ­ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª: ${countJSONKeys(content)}
- Ø£Ø­Ø¬Ø§Ù… Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª: ${getJSONSizes(files)}
- Ù…Ø¹Ø¯Ù„ Ø§Ù„ØªØ¹Ù‚ÙŠØ¯: ${calculateJSONComplexity(content)}

ğŸ”§ Ù‡ÙŠÙƒÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:
---------------
${getJSONSchemas(files)}

ğŸ” Ø£Ù†Ù…Ø§Ø· Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:
---------------
${detectJSONPatterns(content)}

================================================================================
*/`;
                break;

            default:
                header = `/*
================================================================================
Ù…Ù„Ù ØªØ¬Ù…ÙŠØ¹ÙŠ Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ø£Ø®Ø±Ù‰ ÙÙŠ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹: ${projectName}
ØªÙ… Ø¥Ù†Ø´Ø§Ø¤Ù‡ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¨ÙˆØ§Ø³Ø·Ø© Ø£Ø¯Ø§Ø© ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹
ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡: ${new Date().toLocaleString('ar-EG')}
================================================================================

ğŸ“‹ Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø©:
-------------
Ù‡Ø°Ø§ Ø§Ù„Ù…Ù„Ù ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø© ÙÙŠ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹
ÙŠØ´Ù…Ù„: ØµÙˆØ±ØŒ Ø®Ø·ÙˆØ·ØŒ Ø¥Ø¹Ø¯Ø§Ø¯Ø§ØªØŒ Ù†ØµÙˆØµØŒ ÙˆÙ…Ù„ÙØ§Øª Ø§Ù„ØªÙ‡ÙŠØ¦Ø©

ğŸ”— Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª Ø¨ÙŠÙ† Ø§Ù„Ù…Ù„ÙØ§Øª:
------------------------
${generateDependencyAnalysis('other')}

ğŸ¯ Ø£Ø¯ÙˆØ§Ø± Ø§Ù„Ù…Ù„ÙØ§Øª:
----------------
${Object.keys(files).map(path => `
ğŸ“ ${path}:
   - Ø§Ù„ÙˆØ¸ÙŠÙØ©: ${files[path]}
   - Ø§Ù„Ù†ÙˆØ¹: ${getOtherFileType(path)}
   - Ø§Ù„Ø¯ÙˆØ±: ${getOtherFileRole(path)}
   - Ø§Ù„Ø£Ù‡Ù…ÙŠØ©: ${getOtherFileImportance(path)}
   - Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª: ${getOtherFileRelations(path)}
`).join('')}

ğŸ“Š Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª:
-----------
- Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ø£Ø®Ø±Ù‰: ${Object.keys(files).length}
- Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ù…Ù„ÙØ§Øª: ${getOtherFileTypes(files)}
- Ø£Ø­Ø¬Ø§Ù… Ø§Ù„Ù…Ù„ÙØ§Øª: ${getOtherFileSizes(files)}
- Ø§Ù„ØªÙˆØ²ÙŠØ¹: ${getOtherFilesDistribution(files)}

ğŸ“ ØªØµÙ†ÙŠÙ Ø§Ù„Ù…Ù„ÙØ§Øª:
---------------
${getOtherFilesClassification(files)}

ğŸ” Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„ØªÙ‚Ù†ÙŠ:
---------------
${analyzeOtherFiles(files)}

================================================================================
*/`;
        }

        return header + '\n\n' + content;
    }

    function generateDependencyAnalysis(fileType) {
        let analysis = "";
        
        switch(fileType) {
            case "html":
                if (Object.keys(dependencyMap.htmlToCss).length > 0) {
                    analysis += "- ÙŠØ³ØªØ¯Ø¹ÙŠ Ù…Ù„ÙØ§Øª CSS Ø¹Ø¨Ø± <link rel=\"stylesheet\">\n";
                    for (let htmlFile in dependencyMap.htmlToCss) {
                        analysis += `  - ${htmlFile} â†’ ${dependencyMap.htmlToCss[htmlFile].join(', ')}\n`;
                    }
                }
                if (Object.keys(dependencyMap.htmlToJs).length > 0) {
                    analysis += "- ÙŠØ³ØªØ¯Ø¹ÙŠ Ù…Ù„ÙØ§Øª JavaScript Ø¹Ø¨Ø± <script>\n";
                    for (let htmlFile in dependencyMap.htmlToJs) {
                        analysis += `  - ${htmlFile} â†’ ${dependencyMap.htmlToJs[htmlFile].join(', ')}\n`;
                    }
                }
                break;
                
            case "css":
                if (Object.keys(dependencyMap.cssToJs).length > 0) {
                    analysis += "- ÙŠØ³ØªØ¯Ø¹ÙŠ Ù…Ù„ÙØ§Øª CSS Ø£Ø®Ø±Ù‰ Ø¹Ø¨Ø± @import\n";
                    for (let cssFile in dependencyMap.cssToJs) {
                        analysis += `  - ${cssFile} â†’ ${dependencyMap.cssToJs[cssFile].join(', ')}\n`;
                    }
                }
                analysis += "- ÙŠØªÙ… Ø§Ø³ØªØ¯Ø¹Ø§Ø¤Ù‡Ø§ Ù…Ù† Ù‚Ø¨Ù„ Ù…Ù„ÙØ§Øª HTML\n";
                for (let htmlFile in dependencyMap.htmlToCss) {
                    dependencyMap.htmlToCss[htmlFile].forEach(cssFile => {
                        analysis += `  - ${htmlFile} â† ${cssFile}\n`;
                    });
                }
                break;
                
            case "js":
                if (Object.keys(dependencyMap.jsToJson).length > 0) {
                    analysis += "- ÙŠØ³ØªØ¯Ø¹ÙŠ Ù…Ù„ÙØ§Øª JSON\n";
                    for (let jsFile in dependencyMap.jsToJson) {
                        analysis += `  - ${jsFile} â†’ ${dependencyMap.jsToJson[jsFile].join(', ')}\n`;
                    }
                }
                if (Object.keys(dependencyMap.jsToHtml).length > 0) {
                    analysis += "- ÙŠØªÙØ§Ø¹Ù„ Ù…Ø¹ Ø¹Ù†Ø§ØµØ± HTML\n";
                    for (let jsFile in dependencyMap.jsToHtml) {
                        analysis += `  - ${jsFile} â†’ ${dependencyMap.jsToHtml[jsFile].join(', ')}\n`;
                    }
                }
                analysis += "- ÙŠØªÙ… Ø§Ø³ØªØ¯Ø¹Ø§Ø¤Ù‡Ø§ Ù…Ù† Ù‚Ø¨Ù„ Ù…Ù„ÙØ§Øª HTML\n";
                for (let htmlFile in dependencyMap.htmlToJs) {
                    dependencyMap.htmlToJs[htmlFile].forEach(jsFile => {
                        analysis += `  - ${htmlFile} â† ${jsFile}\n`;
                    });
                }
                break;
                
            case "json":
                analysis += "- ÙŠØªÙ… Ù‚Ø±Ø§Ø¡ØªÙ‡Ø§ Ø¨ÙˆØ§Ø³Ø·Ø© Ù…Ù„ÙØ§Øª JavaScript\n";
                for (let jsFile in dependencyMap.jsToJson) {
                    dependencyMap.jsToJson[jsFile].forEach(jsonFile => {
                        analysis += `  - ${jsFile} â† ${jsonFile}\n`;
                    });
                }
                break;
        }
        
        return analysis || "- Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¹Ù„Ø§Ù‚Ø§Øª Ø®Ø§Ø±Ø¬ÙŠØ© Ù…Ø­Ø¯Ø¯Ø©";
    }

    function saveFile(content, name, type, fileType, files) {
        if (!content.trim()) {
            alert(`Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø­ØªÙˆÙ‰ Ù„Ù…Ù„ÙØ§Øª ${name.split('.')[0]}`);
            return;
        }
        
        let detailedContent = generateDetailedContent(content, fileType, files);
        let blob = new Blob([detailedContent], { type });
        let a = document.createElement("a");
        a.href = URL.createObjectURL(blob);
        a.download = name;
        a.click();
    }

    saveFile(cssContent, "all-css-with-detailed-analysis.css", "text/css", "css", relations.css);
    saveFile(htmlContent, "all-html-with-detailed-analysis.html", "text/html", "html", relations.html);
    saveFile(jsContent, "all-js-with-detailed-analysis.js", "application/javascript", "js", relations.js);
    saveFile(jsonContent, "all-json-with-detailed-analysis.json", "application/json", "json", relations.json);
    saveFile(otherContent, "other-files-with-detailed-analysis.txt", "text/plain", "other", relations.other);
}

// ØªØµØ¯ÙŠØ± Ø®Ø±ÙŠØ·Ø© Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª
function exportRelations() {
    const relationData = {
        project: projectName,
        timestamp: new Date().toISOString(),
        dependencies: dependencyMap,
        structure: projectStructure,
        files: {
            html: Object.keys(relations.html),
            css: Object.keys(relations.css),
            js: Object.keys(relations.js),
            json: Object.keys(relations.json),
            other: Object.keys(relations.other)
        }
    };
    
    const content = JSON.stringify(relationData, null, 2);
    let blob = new Blob([content], { type: "application/json" });
    let a = document.createElement("a");
    a.href = URL.createObjectURL(blob);
    a.download = "project-relations-map.json";
    a.click();
}

// =============================================================================
// Ø§Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø© Ù„Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„ØªÙØµÙŠÙ„ÙŠ
// =============================================================================

// Ø¯ÙˆØ§Ù„ ØªØ­Ù„ÙŠÙ„ CSS
function getCSSRole(path) {
    if (path.includes('main') || path.includes('style')) return 'Ø§Ù„ØªØµÙ…ÙŠÙ… Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ ÙˆØ§Ù„ØªØ®Ø·ÙŠØ· Ø§Ù„Ø¹Ø§Ù…';
    if (path.includes('responsive') || path.includes('mobile')) return 'Ø§Ù„ØªØµÙ…ÙŠÙ… Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨ÙŠ Ù„Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„Ù…Ø®ØªÙ„ÙØ©';
    if (path.includes('component') || path.includes('module')) return 'Ø£Ù†Ù…Ø§Ø· Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª Ø§Ù„Ø®Ø§ØµØ©';
    if (path.includes('layout')) return 'ØªØ®Ø·ÙŠØ· Ø§Ù„ØµÙØ­Ø© ÙˆØ§Ù„Ù‡ÙŠÙƒÙ„ Ø§Ù„Ø¹Ø§Ù…';
    return 'Ø£Ù†Ù…Ø§Ø· Ù…Ø³Ø§Ø¹Ø¯Ø© ÙˆØ¥Ø¶Ø§ÙÙŠØ©';
}

function getCSSTargets(path) {
    if (path.includes('layout')) return 'Ø§Ù„Ù‡ÙŠÙƒÙ„ Ø§Ù„Ø¹Ø§Ù…ØŒ Ø§Ù„Ø´Ø¨ÙƒØ©ØŒ ÙˆØ§Ù„ØªØ®Ø·ÙŠØ·';
    if (path.includes('form')) return 'Ø§Ù„Ø­Ù‚ÙˆÙ„ØŒ Ø§Ù„Ø£Ø²Ø±Ø§Ø±ØŒ ÙˆØ§Ù„Ù†Ù…Ø§Ø°Ø¬';
    if (path.includes('nav')) return 'Ø§Ù„Ù‚ÙˆØ§Ø¦Ù… ÙˆØ§Ù„ØªÙ†Ù‚Ù„';
    if (path.includes('button')) return 'Ø§Ù„Ø£Ø²Ø±Ø§Ø± ÙˆØªÙØ§Ø¹Ù„Ø§ØªÙ‡Ø§';
    return 'Ø¹Ù†Ø§ØµØ± Ø¹Ø§Ù…Ø© ÙˆÙ…ØªÙ†ÙˆØ¹Ø©';
}

function getCSSRelations(path) {
    if (path.includes('component')) return 'Ù…Ø±ØªØ¨Ø· Ø¨Ù…ÙƒÙˆÙ†Ø§Øª JavaScript';
    if (path.includes('theme')) return 'ÙŠØ­Ø¯Ø¯ Ø§Ù„Ø³Ù…Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø© Ù„Ù„ØªØ·Ø¨ÙŠÙ‚';
    return 'Ù…Ø³ØªÙ‚Ù„ Ø£Ùˆ Ù…Ø±ØªØ¨Ø· Ø¨Ø¹Ø¯Ø© Ù…ÙƒÙˆÙ†Ø§Øª';
}

function getMainCSSFiles(files) {
    return Object.keys(files).filter(f => 
        f.includes('main') || f.includes('style') || f.includes('global')
    ).join(', ');
}

function calculateRepetitionRate(content) {
    const lines = content.split('\n');
    const uniqueLines = [...new Set(lines)];
    return ((1 - uniqueLines.length / lines.length) * 100).toFixed(1) + '%';
}

function detectCSSPatterns(content) {
    const patterns = [];
    if (content.includes('grid')) patterns.push('â€¢ CSS Grid Ù„Ù„ØªØ®Ø·ÙŠØ·');
    if (content.includes('flex')) patterns.push('â€¢ Flexbox Ù„Ù„Ù…Ø­Ø§Ø°Ø§Ø©');
    if (content.includes('@media')) patterns.push('â€¢ Ø§Ù„ØªØµÙ…ÙŠÙ… Ø§Ù„Ù…ØªØ¬Ø§ÙˆØ¨');
    if (content.includes('animation')) patterns.push('â€¢ Ø§Ù„Ø­Ø±ÙƒØ§Øª ÙˆØ§Ù„ØªÙØ¹ÙŠÙ„Ø§Øª');
    return patterns.join('\n');
}

function getCSSRecommendations(files) {
    const recommendations = [];
    const fileCount = Object.keys(files).length;
    
    if (fileCount > 5) recommendations.push('â€¢ ÙŠÙ…ÙƒÙ† ØªÙ‚Ø³ÙŠÙ… Ù…Ù„ÙØ§Øª CSS Ø¥Ù„Ù‰ ÙˆØ­Ø¯Ø§Øª Ø£ØµØºØ±');
    if (Object.keys(files).some(f => f.includes('important'))) recommendations.push('â€¢ ØªØ¬Ù†Ø¨ Ø§Ø³ØªØ®Ø¯Ø§Ù… !important Ø¨Ø´ÙƒÙ„ Ù…ÙØ±Ø·');
    
    return recommendations.length > 0 ? recommendations.join('\n') : 'â€¢ Ø§Ù„Ù‡ÙŠÙƒÙ„ Ø§Ù„Ø­Ø§Ù„ÙŠ Ø¬ÙŠØ¯';
}

// Ø¯ÙˆØ§Ù„ ØªØ­Ù„ÙŠÙ„ HTML
function getHTMLPageType(path) {
    if (path.includes('index')) return 'Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©';
    if (path.includes('admin')) return 'Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…';
    if (path.includes('login')) return 'ØµÙØ­Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„';
    if (path.includes('dashboard')) return 'Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª';
    return 'ØµÙØ­Ø© Ù…Ø­ØªÙˆÙ‰';
}

function getHTMLComponents(path) {
    if (path.includes('header')) return 'Ø±Ø£Ø³ Ø§Ù„ØµÙØ­Ø©ØŒ Ø´Ø¹Ø§Ø±ØŒ Ù‚ÙˆØ§Ø¦Ù…';
    if (path.includes('footer')) return 'ØªØ°ÙŠÙŠÙ„ Ø§Ù„ØµÙØ­Ø©ØŒ Ø±ÙˆØ§Ø¨Ø·ØŒ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª';
    if (path.includes('sidebar')) return 'Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØŒ Ø§Ù„ØªÙ†Ù‚Ù„ Ø§Ù„Ø«Ø§Ù†ÙˆÙŠ';
    return 'Ù…Ø­ØªÙˆÙ‰ Ø±Ø¦ÙŠØ³ÙŠ ÙˆØ¹Ù†Ø§ØµØ± Ù…ØªÙ†ÙˆØ¹Ø©';
}

function getHTMLLinkedFiles(path) {
    if (path.includes('app') || path.includes('main')) return 'Ø¬Ù…ÙŠØ¹ Ù…Ù„ÙØ§Øª CSS ÙˆJS Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©';
    return 'Ù…Ù„ÙØ§Øª Ù…Ø­Ø¯Ø¯Ø© Ø­Ø³Ø¨ Ø§Ù„ØµÙØ­Ø©';
}

function countHTMLElements(content) {
    const matches = content.match(/<[^>]+>/g);
    return matches ? matches.length : 0;
}

function calculateInteractivityRate(content) {
    const totalElements = countHTMLElements(content);
    const interactiveElements = (content.match(/onclick|onchange|onsubmit|addEventListener/g) || []).length;
    return totalElements > 0 ? ((interactiveElements / totalElements) * 100).toFixed(1) + '%' : '0%';
}

function getCommonComponents(files) {
    const components = [];
    if (Object.keys(files).some(f => f.includes('header'))) components.push('Ø±Ø£Ø³ Ø§Ù„ØµÙØ­Ø©');
    if (Object.keys(files).some(f => f.includes('footer'))) components.push('ØªØ°ÙŠÙŠÙ„ Ø§Ù„ØµÙØ­Ø©');
    if (Object.keys(files).some(f => f.includes('nav'))) components.push('Ø§Ù„ØªÙ†Ù‚Ù„');
    return components.join('ØŒ ');
}

function detectHTMLPatterns(content) {
    const patterns = [];
    if (content.includes('<!DOCTYPE html>')) patterns.push('â€¢ HTML5 Standard');
    if (content.includes('<section')) patterns.push('â€¢ HTML5 Semantic Sections');
    if (content.includes('data-')) patterns.push('â€¢ Custom Data Attributes');
    return patterns.join('\n');
}

// Ø¯ÙˆØ§Ù„ ØªØ­Ù„ÙŠÙ„ JavaScript
function getJSPattern(path) {
    if (path.includes('module') || path.includes('class')) return 'Ø¨Ø±Ù…Ø¬Ø© ÙƒØ§Ø¦Ù†ÙŠØ© Ø§Ù„ØªÙˆØ¬Ù‡ (OOP)';
    if (path.includes('util') || path.includes('helper')) return 'ÙˆØ¸Ø§Ø¦Ù Ù…Ø³Ø§Ø¹Ø¯Ø© (Utility)';
    if (path.includes('component')) return 'Ù…ÙƒÙˆÙ†Ø§Øª UI';
    return 'Ø¨Ø±Ù…Ø¬Ø© Ø¥Ø¬Ø±Ø§Ø¦ÙŠØ© (Procedural)';
}

function getJSFunctions(path) {
    if (path.includes('api')) return 'Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®ÙˆØ§Ø¯Ù… ÙˆAPIs';
    if (path.includes('event')) return 'Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø£Ø­Ø¯Ø§Ø« ÙˆØ§Ù„ØªÙØ§Ø¹Ù„Ø§Øª';
    if (path.includes('util')) return 'ÙˆØ¸Ø§Ø¦Ù Ù…Ø³Ø§Ø¹Ø¯Ø© ÙˆØ¹Ù…Ù„ÙŠØ§Øª';
    return 'ÙˆØ¸Ø§Ø¦Ù Ø¹Ø§Ù…Ø© ÙˆÙ…Ù†Ø·Ù‚ ØªØ·Ø¨ÙŠÙ‚ÙŠ';
}

function getJSDependencies(path) {
    if (path.includes('app') || path.includes('main')) return 'Ø§Ù„ØªØ¨Ø¹ÙŠØ§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© Ù„Ù„ØªØ·Ø¨ÙŠÙ‚';
    return 'ØªØ¨Ø¹ÙŠØ§Øª Ù…Ø­Ø¯ÙˆØ¯Ø© Ø£Ùˆ Ø¯Ø§Ø®Ù„ÙŠØ©';
}

function getJSAPIs(path) {
    const apis = projectStructure.dataFlows
        .filter(flow => flow.file === path)
        .flatMap(flow => flow.apis);
    return apis.length > 0 ? apis.join(', ') : 'Ù„Ø§ ØªÙˆØ¬Ø¯';
}

function countJSFunctions(content) {
    return (content.match(/function\s+(\w+)|const\s+(\w+)\s*=\s*\(|let\s+(\w+)\s*=\s*\(/g) || []).length;
}

function calculateJSComplexity(path) {
    if (path.includes('util') || path.includes('helper')) return 'Ù…Ù†Ø®ÙØ¶';
    if (path.includes('component')) return 'Ù…ØªÙˆØ³Ø·';
    return 'Ù…Ø±ØªÙØ¹';
}

function calculateJSInteractivity(content) {
    const totalLines = content.split('\n').length;
    const eventLines = (content.match(/addEventListener|onclick|onchange|onsubmit/g) || []).length;
    return totalLines > 0 ? ((eventLines / totalLines) * 100).toFixed(1) + '%' : '0%';
}

function detectJSPatterns(content) {
    const patterns = [];
    if (content.includes('document.querySelector')) patterns.push('â€¢ DOM Manipulation');
    if (content.includes('addEventListener')) patterns.push('â€¢ Event Handling');
    if (content.includes('fetch') || content.includes('axios')) patterns.push('â€¢ API Calls');
    if (content.includes('class ')) patterns.push('â€¢ ES6 Classes');
    return patterns.join('\n');
}

// Ø¯ÙˆØ§Ù„ ØªØ­Ù„ÙŠÙ„ JSON
function getJSONDataType(path) {
    if (path.includes('config')) return 'Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚';
    if (path.includes('data')) return 'Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚';
    if (path.includes('i18n')) return 'ØªØ±Ø¬Ù…Ø© ÙˆÙ†ØµÙˆØµ';
    if (path.includes('package')) return 'Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…Ø´Ø±ÙˆØ¹';
    return 'Ø¨ÙŠØ§Ù†Ø§Øª Ø¹Ø§Ù…Ø©';
}

function getJSONStructure(path) {
    if (path.includes('config')) return 'Ù…ÙØªØ§Ø­-Ù‚ÙŠÙ…Ø© Ù„Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª';
    if (path.includes('i18n')) return 'ÙƒØ§Ø¦Ù†Ø§Øª Ù…ØªØ¯Ø§Ø®Ù„Ø© Ù„Ù„ØºØ§Øª';
    return 'Ù‡ÙŠÙƒÙ„ Ù…ØªØ¯Ø§Ø®Ù„ Ø£Ùˆ Ù…ØµÙÙˆÙØ§Øª';
}

function getJSONUsage(path) {
    if (path.includes('config')) return 'Ø§Ù„ØªÙ‡ÙŠØ¦Ø© ÙˆØ§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª';
    if (path.includes('data')) return 'ØªØ®Ø²ÙŠÙ† ÙˆØ¹Ø±Ø¶ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª';
    return 'Ø£ØºØ±Ø§Ø¶ Ù…ØªØ¹Ø¯Ø¯Ø©';
}

function countJSONKeys(content) {
    try {
        const data = JSON.parse(content);
        return countKeys(data);
    } catch(e) {
        return 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯';
    }
}

function countKeys(obj) {
    let count = 0;
    for (let key in obj) {
        count++;
        if (typeof obj[key] === 'object' && obj[key] !== null) {
            count += countKeys(obj[key]);
        }
    }
    return count;
}

function calculateJSONComplexity(content) {
    try {
        const data = JSON.parse(content);
        const depth = calculateDepth(data);
        if (depth > 3) return 'Ù…Ø±ØªÙØ¹';
        if (depth > 2) return 'Ù…ØªÙˆØ³Ø·';
        return 'Ù…Ù†Ø®ÙØ¶';
    } catch(e) {
        return 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯';
    }
}

// Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¯Ø§Ù„Ø© Ø§Ù„Ù…ÙÙ‚ÙˆØ¯Ø© detectJSONPatterns
function detectJSONPatterns(content) {
    try {
        const data = JSON.parse(content);
        const patterns = [];
        
        if (Array.isArray(data)) {
            patterns.push('â€¢ Ù…ØµÙÙˆÙØ© Ø¨ÙŠØ§Ù†Ø§Øª');
            if (data.length > 0 && typeof data[0] === 'object') {
                patterns.push('â€¢ Ù…ØµÙÙˆÙØ© Ù…Ù† Ø§Ù„ÙƒØ§Ø¦Ù†Ø§Øª');
            }
        } else if (typeof data === 'object') {
            patterns.push('â€¢ ÙƒØ§Ø¦Ù† Ø¨ÙŠØ§Ù†Ø§Øª');
            
            if (data.dependencies || data.devDependencies) {
                patterns.push('â€¢ ØªØ¨Ø¹ÙŠØ§Øª Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ (package.json)');
            }
            
            if (data.scripts) {
                patterns.push('â€¢ Ø³ÙƒØ±ÙŠØ¨ØªØ§Øª Ø§Ù„ØªØ´ØºÙŠÙ„');
            }
            
            if (data.name && data.version) {
                patterns.push('â€¢ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚');
            }
            
            // ØªØ­Ù„ÙŠÙ„ Ø¹Ù…Ù‚ Ø§Ù„ÙƒØ§Ø¦Ù†
            const depth = calculateDepth(data);
            if (depth > 3) patterns.push('â€¢ Ù‡ÙŠÙƒÙ„ Ù…ØªØ¯Ø§Ø®Ù„ Ø¨Ø¹Ù…Ù‚');
            else if (depth > 1) patterns.push('â€¢ Ù‡ÙŠÙƒÙ„ Ù…ØªØ¯Ø§Ø®Ù„ Ù…ØªÙˆØ³Ø·');
            else patterns.push('â€¢ Ù‡ÙŠÙƒÙ„ Ø¨Ø³ÙŠØ·');
        }
        
        return patterns.length > 0 ? patterns.join('\n') : 'â€¢ Ù‡ÙŠÙƒÙ„ Ù‚ÙŠØ§Ø³ÙŠ';
    } catch(e) {
        return 'â€¢ Ù‡ÙŠÙƒÙ„ ØºÙŠØ± ØµØ§Ù„Ø­ Ø£Ùˆ Ø¨Ù‡ Ø£Ø®Ø·Ø§Ø¡';
    }
}

// ØªØ£ÙƒØ¯ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø§Ù„Ø¯Ø§Ù„Ø© calculateDepth Ø¥Ø°Ø§ Ù„Ù… ØªÙƒÙ† Ù…ÙˆØ¬ÙˆØ¯Ø©
function calculateDepth(obj, currentDepth = 0) {
    if (typeof obj !== 'object' || obj === null) return currentDepth;
    
    let maxDepth = currentDepth;
    for (let key in obj) {
        if (typeof obj[key] === 'object' && obj[key] !== null) {
            const depth = calculateDepth(obj[key], currentDepth + 1);
            maxDepth = Math.max(maxDepth, depth);
        }
    }
    return maxDepth;
}

// Ø¯ÙˆØ§Ù„ Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ø£Ø®Ø±Ù‰
function getOtherFileType(path) {
    if (path.endsWith('.md')) return 'ÙˆØ«Ø§Ø¦Ù‚ Markdown';
    if (path.endsWith('.txt')) return 'Ù†Øµ Ø¹Ø§Ø¯ÙŠ';
    if (path.endsWith('.xml')) return 'Ø¨ÙŠØ§Ù†Ø§Øª XML';
    if (path.endsWith('.svg')) return 'ØµÙˆØ± Ù…ØªØ¬Ù‡ÙŠØ©';
    return 'Ù…Ù„Ù Ù†Ø¸Ø§Ù… Ø£Ùˆ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª';
}

function getOtherFileRole(path) {
    if (path.includes('readme')) return 'ÙˆØ«Ø§Ø¦Ù‚ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹';
    if (path.includes('license')) return 'Ø§Ù„ØªØ±Ø®ÙŠØµ ÙˆØ§Ù„Ø´Ø±ÙˆØ·';
    if (path.includes('gitignore')) return 'Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Git';
    return 'Ù…Ù„Ù Ù…Ø³Ø§Ø¹Ø¯ Ø£Ùˆ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª';
}

function getOtherFileImportance(path) {
    if (path.includes('readme') || path.includes('license')) return 'Ø¹Ø§Ù„ÙŠØ©';
    if (path.includes('config')) return 'Ù…ØªÙˆØ³Ø·Ø©';
    return 'Ù…Ù†Ø®ÙØ¶Ø©';
}

// Ø¯ÙˆØ§Ù„ Ø¹Ø§Ù…Ø©
function countLines(content) {
    return content.split('\n').length;
}

function countFunctions(content) {
    return (content.match(/function\s+\w+|const\s+\w+\s*=\s*\(|let\s+\w+\s*=\s*\(/g) || []).length;
}

function showLoading(show) {
    document.getElementById("loading").style.display = show ? "block" : "none";
}

// ØªØµÙÙŠØ© Ø§Ù„Ø´Ø¬Ø±Ø© Ø­Ø³Ø¨ Ø§Ù„Ø¨Ø­Ø«
function filterTree() {
    const searchTerm = document.getElementById("searchInput").value.toLowerCase();
    const allItems = document.querySelectorAll('.folder, .file');
    
    if (!searchTerm) {
        allItems.forEach(item => item.style.display = 'flex');
        return;
    }
    
    allItems.forEach(item => {
        const text = item.textContent.toLowerCase();
        if (text.includes(searchTerm)) {
            item.style.display = 'flex';
            // ÙØªØ­ Ø§Ù„Ù…Ø¬Ù„Ø¯Ø§Øª Ø§Ù„ØªÙŠ ØªØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ù†ØªØ§Ø¦Ø¬
            if (item.classList.contains('file')) {
                let parentFolder = item.closest('.sub').previousElementSibling;
                if (parentFolder) {
                    parentFolder.style.display = 'flex';
                    let panel = parentFolder.nextElementSibling;
                    if (panel && panel.style.display === "none") {
                        toggleFolder(parentFolder);
                    }
                }
            }
        } else {
            item.style.display = 'none';
        }
    });
}

// Ù…Ø³Ø­ Ø§Ù„Ø¨Ø­Ø«
function clearSearch() {
    document.getElementById("searchInput").value = '';
    filterTree();
}

// Ø§Ù„ØªØµÙÙŠØ© Ø­Ø³Ø¨ Ù†ÙˆØ¹ Ø§Ù„Ù…Ù„Ù
function filterByType(type) {
    const allItems = document.querySelectorAll('.folder, .file');
    
    if (type === 'all') {
        allItems.forEach(item => item.style.display = 'flex');
        return;
    }
    
    allItems.forEach(item => {
        if (item.classList.contains('folder')) {
            // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù…Ø¬Ù„Ø¯Ø§Øª Ø¯Ø§Ø¦Ù…Ù‹Ø§
            item.style.display = 'flex';
        } else if (item.dataset.type === type) {
            item.style.display = 'flex';
        } else {
            item.style.display = 'none';
        }
    });
}

// ØªØµØ¯ÙŠØ± TXT
function exportTxt() {
    let content = document.getElementById("output").value;
    if (!content.trim()) {
        alert("Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø­ØªÙˆÙ‰ Ù„Ù„ØªØµØ¯ÙŠØ±");
        return;
    }
    
    let blob = new Blob([content], { type:"text/plain" });
    let a = document.createElement("a");
    a.href = URL.createObjectURL(blob);
    a.download = "all-project.txt";
    a.click();
}

// ØªØµØ¯ÙŠØ± MD
function exportMd() {
    let content = document.getElementById("output").value;
    if (!content.trim()) {
        alert("Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø­ØªÙˆÙ‰ Ù„Ù„ØªØµØ¯ÙŠØ±");
        return;
    }
    
    let blob = new Blob([content], { type:"text/markdown" });
    let a = document.createElement("a");
    a.href = URL.createObjectURL(blob);
    a.download = "all-project.md";
    a.click();
}

// Ø¯ÙˆØ§Ù„ Ø¥Ø¶Ø§ÙÙŠØ© Ù„Ù„ØªØ­Ù„ÙŠÙ„ (ÙŠÙ…ÙƒÙ† ØªØ·ÙˆÙŠØ±Ù‡Ø§)
function getHTMLStructure(files) {
    return "Ù‡ÙŠÙƒÙ„ ØªÙ‚Ù„ÙŠØ¯ÙŠ HTML5 Ù…Ø¹ Ø£Ù‚Ø³Ø§Ù… Ø¯Ù„Ø§Ù„ÙŠØ©";
}

function getJSArchitecture(files) {
    return "Ù‡Ù†Ø¯Ø³Ø© ØªÙ‚Ù„ÙŠØ¯ÙŠØ© ØªØ¹ØªÙ…Ø¯ Ø¹Ù„Ù‰ DOM ÙˆØ§Ù„ÙˆØ¸Ø§Ø¦Ù";
}

function getJSDataFlow(files) {
    return "ØªØ¯ÙÙ‚ Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø§Ù„Ø®Ø§Ø¯Ù… Ø¥Ù„Ù‰ Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© ÙˆØ§Ù„Ø¹ÙƒØ³";
}

function getJSONSchemas(files) {
    return "Ù‡ÙŠØ§ÙƒÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ù…ØªØ¯Ø§Ø®Ù„Ø© Ù„Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª ÙˆØ§Ù„Ù…Ø­ØªÙˆÙ‰";
}

function getOtherFilesClassification(files) {
    return "Ù…Ù„ÙØ§Øª ÙˆØ«Ø§Ø¦Ù‚ÙŠØ© ÙˆØ¥Ø¹Ø¯Ø§Ø¯Ø§Øª ÙˆÙ…ÙˆØ§Ø±Ø¯";
}

function getOtherFilesDistribution(files) {
    return "ØªÙˆØ²ÙŠØ¹ Ù…ØªÙ†ÙˆØ¹ Ø¨ÙŠÙ† Ø§Ù„ÙˆØ«Ø§Ø¦Ù‚ ÙˆØ§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª";
}

function analyzeOtherFiles(files) {
    return "ØªØ­Ù„ÙŠÙ„ ØªÙ‚Ù†ÙŠ Ù„Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø© ÙˆØ§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª";
}

function getHTMLStructureAnalysis(path) {
    return "Ù‡ÙŠÙƒÙ„ Ù‚ÙŠØ§Ø³ÙŠ Ù…Ø¹ Ø±Ø£Ø³ ÙˆÙ…Ø­ØªÙˆÙ‰ ÙˆØªØ°ÙŠÙŠÙ„";
}

function getJSLibraries(files) {
    return "Ù…ÙƒØªØ¨Ø§Øª JavaScript Ù…Ø­ØªÙ…Ù„Ø©";
}

function getJSONSize(path) {
    return "Ø­Ø¬Ù… Ø¨ÙŠØ§Ù†Ø§Øª Ù…ØªÙˆØ³Ø·";
}

function getOtherFileRelations(path) {
    return "Ù…Ø±ØªØ¨Ø· Ø¨Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© Ù„Ù„ØªØ·Ø¨ÙŠÙ‚";
}

function getOtherFileTypes(files) {
    const types = [];
    Object.keys(files).forEach(path => {
        if (path.endsWith('.md')) types.push('ÙˆØ«Ø§Ø¦Ù‚');
        else if (path.endsWith('.txt')) types.push('Ù†Øµ');
        else types.push('Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª');
    });
    return [...new Set(types)].join('ØŒ ');
}

function getOtherFileSizes(files) {
    return "Ø£Ø­Ø¬Ø§Ù… Ù…ØªÙ†ÙˆØ¹Ø© Ø­Ø³Ø¨ Ù†ÙˆØ¹ Ø§Ù„Ù…Ù„Ù";
}

function getJSONSizes(files) {
    return "Ø£Ø­Ø¬Ø§Ù… Ù…ØªÙ†ÙˆØ¹Ø© Ø­Ø³Ø¨ Ù†ÙˆØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª";
}
</script>

</body>
</html>