<style>
  /*
  @file pages/header.html
  @description Header component styles and logic. Handles the animated title and navigation bar.
*/

  /* === Header Container === */
  .container {
    position: fixed;
    /* Fix header at the top of the page */
    top: 0;
    left: 0;
    width: 100%;
    background-color: #f9f9f9;
    /* White background for header */
    height: 100vh;
    /* Fixed height 10% of screen height */
    z-index: -1;
    /* Ensure it stays on top of other content */
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    /* Lighter shadow for a light theme */

    /* Use Flexbox for alignment */
    display: flex;
    justify-content: space-between;
    /* Pushes items to the edges */
    align-items: center;
    padding: 0.5rem 5vw;
    /* Responsive horizontal padding */
    box-sizing: border-box;
    /* Ensures padding is included in the width */
  }

  /* === Animated Header Title ("Suez Bazaar" and "SB") === */
  .bazaar-title {
    font-size: clamp(10px, 2.5vh, 28px);
    /* Responsive font size with min/max */
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.1em;
    /* This will be a flex container for the letters */
    display: inline-flex;
    transition: opacity 0.5s ease-out;
    /* Ensure LTR text direction for the title itself, regardless of container direction */
    direction: ltr;
  }

  /* Styling for each letter (span) inside the animated title */
  .bazaar-title span {
    display: inline-block;
    opacity: 0;
    /* ✅ FIX: Apply gradient to each letter individually */
    background: linear-gradient(45deg, #007bff, #03478f);
    -webkit-background-clip: text;
    background-clip: text;
    color: transparent;
    -webkit-text-fill-color: transparent;
    transform: scale(0);
    animation: zoomInLetter 0.4s forwards;
  }

  /* Class to hide title completely during transition */
  .bazaar-title.hidden {
    opacity: 0;
  }

  /* Class for the final state "SB" after animation ends */
  .bazaar-title.final-text {
    font-size: clamp(18px, 3.5vh, 32px);
    /* Responsive font size with min/max */
    opacity: 1;
    transform: scale(1);
    /* Override the flex display to center the block correctly */
    display: inline-block;
    /* ✅ FIX: Restore blue color correctly and remove gradient */
    color: #03478f;
    /* Reset properties that caused text hiding */
    -webkit-text-fill-color: initial;
    font-weight: 600;
    /* Makes text slightly bolder and clearer */
    text-align: center;
    /* Ensures text is centered in container */

  }

  /* Zoom animation for each letter in title */
  @keyframes zoomInLetter {
    to {
      opacity: 1;
      transform: scale(1);
    }
  }

  /* === Animated Text Tagline next to title === */
  .tagline {
    font-family: "Tajawal", sans-serif;
    /* A nice Arabic font */
    font-size: clamp(12px, 1.8vh, 18px);
    /* Responsive font size with min/max */
    color: #003d7a;
    /* ✅ EDIT: Use dark blue shade to enhance visual identity */
    margin-right: 1.5rem;
    /* Space between SB and the text, margin-right for RTL */
    opacity: 0;
    /* Hidden by default */
    transition: opacity 0.8s ease-in-out;
    /* Slower transition for a smoother effect */
    text-align: right;
    /* Align text to the right for RTL */

  }

  .tagline.visible {
    opacity: 1;
  }

  /* === Content groups inside header === */
  .header-title-group {
    display: flex;
    align-items: baseline;
  }

  /* Container for grouping header controls (search, user) */
  .header-controls {
    display: flex;
    align-items: center;
    gap: 20px;
    /* Space between search section and user section */
  }

  /* Header search section styles */
  .search-container {
    position: relative;
    display: flex;
    align-items: center;
  }

  .search-icon-btn {
    background: none;
    border: none;
    cursor: pointer;
    padding: 8px;
    font-size: clamp(20px, 3.5vh, 26px);
    /* Responsive icon size */

    color: #03478f;
    /* ✅ EDIT: Change search icon color to bright blue */
  }

  /* === User profile section in header === */
  .user-icon {
    font-size: clamp(24px, 4vh, 32px);
    /* Responsive icon size */
    color: #03478f;
    /* ✅ EDIT: Change user icon color to blue */
  }

  /* User profile container (icon + text) */
  .user-profile {
    display: flex;
    flex-direction: column;
    align-items: center;
    cursor: pointer;
    /* Change cursor to indicate clickable */
    gap: 2px;
    /* Small space between icon and text */
  }

  /* User name text under icon */
  .user-text {
    font-family: "Tajawal", sans-serif;
    font-size: clamp(10px, 1.5vh, 12px);
    /* Small and responsive font size */
    color: #03478f;
    /* ✅ EDIT: Change user name color to blue */
    font-weight: bold;
    white-space: nowrap;
    /* Prevent text splitting into two lines */
  }

  /* Link surrounding user profile section to make it clickable */
  .user-profile-link {
    text-decoration: none;
    /* Remove link underline */
    color: inherit;
    /* Inherit color from parent */
    display: flex;
    flex-direction: column;
    align-items: center;
    color: #03478f;
  }
</style>
<a id="header-logo-link" href="index.html" class="header-title-group" style="text-decoration: none; color: inherit">
  <table id="header-logo-table">
    <tr id="header-logo-row">
      <td id="header-logo-cell-title">
        <h1 id="animated-text" class="bazaar-title"></h1>
      </td>
      <td id="header-logo-cell-tagline">
        <p id="tagline" class="tagline"></p>
      </td>
    </tr>
  </table>
</a>
<script>
  const animatedTextElement = document.getElementById("animated-text");
  const taglineElement = document.getElementById("tagline");

  // --- Animation Configuration ---
  const fullText = window.langu("page_title");
  const shortText = window.langu("logo_short");
  const letterAppearDelay = 100; // Delay between each letter appearing
  let isAnimationRunning = false; // Variable to track animation state

  // Helper function for waiting, optimized for animations.
  const wait = (ms) => new Promise((res) => setTimeout(res, ms));
  /**
   * @function hideText
   * @description Hides the currently displayed text.
   * @returns {Promise<void>} - A Promise that resolves after a delay matching the fade-out effect duration.
   */
  async function hideText() {
    return new Promise((resolve) => {
      wait(500).then(resolve); // Matches fade-out duration.
    });
  }
  /**
   * @function showTextWithZoom
   * @description Displays specified text with a gradual zoom-in animation for each letter.
   *   Used for the opening text animation.
   * @param {string} text - The text to display with animation.
   * @returns {Promise<void>} - A Promise that resolves after the animation completes and an additional wait time.
   */
  async function showTextWithZoom(text) {
    return new Promise((resolve) => {
      // ✅ FIX: Full reset to original state
      animatedTextElement.innerHTML = ""; // Clear previous content
      animatedTextElement.classList.remove("final-text"); // Remove final state class

      const container = animatedTextElement.parentElement;
      container.style.justifyContent = "center"; // Re-center alignment
      container.style.direction = "ltr"; // Reset text direction to LTR for "Suez Bazaar"

      // Split text into letters and wrap each in a span
      text.split("").forEach((char, index) => {
        const span = document.createElement("span");
        // Use &nbsp; for space to make it animatable
        span.innerHTML = char === " " ? "&nbsp;" : char;
        // Stagger the animation start time
        span.style.animationDelay = `${index * letterAppearDelay}ms`;
        animatedTextElement.appendChild(span);
      });

      // Calculate total animation time and then call the resolve callback
      const totalAnimationTime = text.length * letterAppearDelay;
      wait(totalAnimationTime + 2000).then(resolve); // 2s delay after animation
    });
  }
  /**
   * @function showFinalText
   * @description Displays the final text (e.g., "SB") and applies final styles.
   * @param {string} text - The final text to display.
   * @returns {Promise<void>} - A Promise that resolves immediately after displaying the final text.
   */
  async function showFinalText(text) {
    return new Promise((resolve) => {
      animatedTextElement.innerHTML = text;
      animatedTextElement.classList.add("final-text");

      const container = animatedTextElement.parentElement;
      container.style.justifyContent = "flex-start";
      container.style.direction = "rtl"; // Set direction for right-to-left layout

      resolve(); // Signal that this step is done
    });
  }
  /**
 * @function startTaglineCarousel
 * @description Starts a carousel of marketing taglines, switching between them with fade-in/out effects.
 * @returns {Promise<void>} - A Promise that resolves after all taglines have been displayed and the last one fades out.
 */
  async function startTaglineCarousel() {
    return new Promise(async (resolve) => {
      // Fetch translated taglines from the translation system
      const sentences = [];
      for (let i = 1; i <= 6; i++) {
        const line = window.langu(`tagline_${i}`);
        if (line && line !== `tagline_${i}`) {
          sentences.push(line);
        }
      }

      // Fallback if no taglines are found
      if (sentences.length === 0) {
        sentences.push(window.langu('page_title'));
      }

      // ✅ FIX: Re-show element before starting sentence display
      taglineElement.style.display = 'block'; // Or 'inline' depending on design

      // Ensure the first sentence always starts hidden
      taglineElement.classList.remove("visible");
      await wait(10); // Short wait to ensure change is applied

      for (const sentence of sentences) {
        if (taglineElement.classList.contains("visible")) {
          taglineElement.classList.remove("visible");
          await wait(800); // Wait for fade-out
        }
        taglineElement.textContent = sentence;
        taglineElement.classList.add("visible");
        await wait(5000); // Wait for sentence to be displayed
      }

      // Fade out the last sentence and resolve the promise
      taglineElement.classList.remove("visible");
      await wait(800);
      resolve();
    });
  }
  /**
 * @function startAnimationCycle
 * @description Starts the main text animation cycle, including showing full text, hiding it, showing final text, and starting the tagline carousel.
 * @returns {Promise<void>} - A Promise that never resolves as it restarts the cycle recursively.
 * @see showTextWithZoom
 * @see hideText
 * @see showFinalText
 * @see startTaglineCarousel
 */
  async function startAnimationCycle() {
    if (isAnimationRunning) return; // Prevent multiple cycles running simultaneously
    isAnimationRunning = true;

    // ✅ FIX: Hide tagline completely (not just transparent)
    // This prevents element from affecting main title alignment in new cycle
    if (taglineElement.classList.contains("visible")) {
      taglineElement.classList.remove("visible"); // Remove transparency
    }
    taglineElement.style.display = 'none'; // Hide element completely
    await wait(800); // Wait for fade-out effect if present

    await showTextWithZoom(fullText);
    await hideText();
    await wait(200); // Short delay
    await showFinalText(shortText);
    await startTaglineCarousel();

    // Call next cycle using requestAnimationFrame to ensure smooth performance
    requestAnimationFrame(() => {
      isAnimationRunning = false;
      startAnimationCycle();
    });
  }
  startAnimationCycle();
</script>