<!DOCTYPE html>
<html lang="ar" dir="rtl">
<!--
  @file login.html
  @description صفحة تسجيل الدخول وإدارة حساب المستخدم.

  هذه الصفحة تخدم غرضين:
  1.  عرض نموذج تسجيل الدخول للمستخدمين غير المسجلين.
  2.  بعد تسجيل الدخول، تتحول إلى لوحة تحكم بسيطة تعرض رسالة ترحيب، زر لإضافة منتج (للبائعين)، وزر لعرض المستخدمين (للمسؤولين).
-->

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>تسجيل الدخول - Suez Bazaar</title>
  <!-- Link to shared styles -->
  <link rel="stylesheet" href="css/style.css" /> <!-- تمت إضافة هذا السطر -->
  <!-- Link to login page specific styles -->
  <link rel="stylesheet" href="css/login.css" />
  <link rel="stylesheet" href="css/login-page.css" /> <!-- ✅ جديد: ملف الأنماط المنفصل -->
  <link rel="stylesheet" href="css/add-product-modal.css" /> <!-- ✅ جديد: أنماط نافذة إضافة منتج -->
  <!-- Global Config -->
  <script src="js/config.js"></script>
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700&display=swap" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700&display=swap" rel="stylesheet" />
  <!-- Font Awesome for icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" />
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

</head>

<body>
  <!-- Header بسيط للاتساق -->
  <div class="container" id="header-container">
    <a href="index.html" id="header-title-link" class="header-title-group" style="text-decoration: none; color: inherit">
      <h1 id="header-title" class="bazaar-title final-text">SB</h1>
      <p id="header-tagline" class="tagline" style="opacity: 1; margin-right: 1.5rem">
        بازار السويس
      </p>
    </a>
    <a href="index.html" id="back-to-home-link" class="back-to-home-btn" title="العودة للصفحة الرئيسية">
      <i class="fas fa-home"></i>
      <span id="back-to-home-text">العودة للرئيسية</span>
    </a>
  </div>

  <!-- حاوية بديلة للمستخدم المسجل دخوله -->
  <div id="logged-in-container" class="login-page-wrapper" style="display: none">
    <div class="login-container">
      <h2 id="welcome-message"></h2>
      <!-- جديد: حاوية رئيسية للأزرار مقسمة إلى مجموعات -->
      <div id="user-action-buttons-container" class="action-buttons">
        <!-- مجموعة المسؤول (تظهر للمسؤول فقط) -->
        <div id="admin-actions" class="button-group" style="display: none; animation-delay: 0s;">
          <h3 id="admin-actions-title"><i class="fas fa-crown"></i> أدوات المسؤول</h3>
          <div id="admin-actions-row" class="button-row">
            <!-- زر لوحة تحكم المسؤول سيتم إضافته هنا بواسطة JS -->
          </div>
        </div>

        <!-- مجموعة البائع (تظهر للبائع فقط) -->
        <div id="seller-actions" class="button-group" style="display: none; animation-delay: 0.1s;">
          <h3 id="seller-actions-title"><i class="fas fa-store"></i> أدوات البائع</h3>
          <div id="seller-actions-row" class="button-row">
            <button id="add-product-btn" class="button logout-btn-small">
              <i class="fas fa-plus"></i> إضافة منتج
            </button>
            <button id="view-my-products-btn" class="button logout-btn-small">
              <i class="fas fa-boxes-stacked"></i> عرض منتجاتي
            </button>
          </div>
        </div>

        <!-- مجموعة العميل (تظهر لجميع المستخدمين) -->
        <div id="customer-actions" class="button-group" style="display: none; animation-delay: 0.2s;">
          <h3 id="customer-actions-title"><i class="fas fa-user"></i> حسابي</h3>
          <div id="customer-actions-row" class="button-row">
            <button id="view-cart-btn" class="button logout-btn-small">
              <i class="fas fa-shopping-cart"></i> عرض السلة
            </button>
            <button id="view-purchases-btn" class="button logout-btn-small">
              <i class="fas fa-history"></i> المشتريات
            </button>
          </div>
        </div>

        <!-- مجموعة الإعدادات (تظهر لجميع المستخدمين) -->
        <div id="user-actions" class="button-group" style="display: none; animation-delay: 0.3s;">
          <h3 id="user-actions-title"><i class="fas fa-cogs"></i> الإعدادات</h3>
          <div id="user-actions-row" class="button-row">
            <button id="edit-profile-btn" class="button logout-btn-small"><i class="fas fa-user-cog"></i> تعديل
              البيانات</button>
            <button id="logout-btn-alt" class="button logout-btn-small"><i class="fas fa-sign-out-alt"></i> تسجيل
              الخروج</button>
          </div>
        </div>
      </div>
      <!-- حاوية لعرض جدول المستخدمين -->
      <div id="users-table-container" style="width: 100%; margin-top: 20px; display: none;">
        <div id="table-content-wrapper"></div> <!-- حاوية مخصصة للجدول أو التحميل -->
        <div id="table-actions" style="display: none; margin-top: 15px; gap: 10px;">
          <button id="update-users-btn" class="button" style="background-color: #28a745;">حفظ التغييرات</button>
          <button id="cancel-update-btn" class="button" style="background-color: #6c757d;">إلغاء التغييرات</button>
        </div>
      </div>
    </div>
  </div>

  <!-- حاوية تسجيل الدخول الافتراضية -->
  <div id="login-form-wrapper" class="login-page-wrapper">
    <div id="login-form-container" class="login-container">
      <h2 id="login-title">تسجيل الدخول</h2>
      <form id="login-form">
        <div id="phone-form-group" class="form-group">
          <label for="phone"><i class="fas fa-phone"></i> رقم الهاتف</label>
          <input type="tel" id="phone" name="phone" required />
          <div id="phone-error" class="error-message"></div>
        </div>
        <button type="submit" class="button login-btn">تسجيل الدخول</button>
        <div id="login-form-footer" class="form-footer">
          <a href="register.html" id="go-to-register-link" class="form-footer-link">ليس لديك حساب؟ <strong>سجل الآن</strong></a>
          <a href="#" id="guest-login-btn" class="guest-login-link">أو يمكنك <strong>الدخول كضيف</strong> لتصفح
            المنتجات</a>
        </div>

      </form>
    </div>
  </div>

  <!-- حاوية النافذة المنبثقة لإضافة منتج -->
  <div id="add-product-modal" class="modal">
    <!-- سيتم تحميل محتوى نموذج إضافة المنتج هنا -->
  </div>
  <!-- جديد: حاوية النافذة المنبثقة للسلة -->
  <div id="cart-modal-container" class="modal">
    <!-- سيتم ملء محتوى السلة هنا -->
  </div>
  <!-- جديد: حاوية النافذة المنبثقة للمشتريات -->
  <div id="purchases-modal-container" class="modal">
    <!-- سيتم ملء محتوى المشتريات هنا -->
  </div>
  <!-- جديد: حاوية النافذة المنبثقة لمنتجاتي -->
  <div id="my-products-modal-container" class="modal">
    <!-- سيتم ملء محتوى منتجاتي هنا -->
  </div>
  <script src="cloudflare-workers/cloudFileManager.js"></script>
  <script src="js/cart.js"></script> <!-- ✅ إضافة: تحميل ملف السلة -->
  <script src="js/auth.js"></script>
  <script src="cart-modal.js"></script> <!-- ✅ إصلاح: تحميل ملف نافذة السلة الذي يحتوي على showCartModal -->
  <script src="js/turo.js"></script>
  <script src="js/login-page.js"></script> <!-- ✅ جديد: ملف الجافاسكريبت المنفصل -->
</body>

</html>